<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Text Analysis | PLSC 31101: Computational Tools for Social Science</title>
  <meta name="description" content="This book contains course notes and other materials for PLSC 31101." />
  <meta name="generator" content="bookdown 0.20.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Text Analysis | PLSC 31101: Computational Tools for Social Science" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://plsc-31101.github.io/course/" />
  
  <meta property="og:description" content="This book contains course notes and other materials for PLSC 31101." />
  <meta name="github-repo" content="plsc-31101/course" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Text Analysis | PLSC 31101: Computational Tools for Social Science" />
  
  <meta name="twitter:description" content="This book contains course notes and other materials for PLSC 31101." />
  

<meta name="author" content="Rochelle Terman" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="collecting-data-from-the-web.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PLSC 31101</a></li>

<li class="divider"></li>
<li class="part"><span><b>I Before Class</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i><b>2</b> Syllabus</a><ul>
<li class="chapter" data-level="2.1" data-path="syllabus.html"><a href="syllabus.html#course-description"><i class="fa fa-check"></i><b>2.1</b> Course Description</a></li>
<li class="chapter" data-level="2.2" data-path="syllabus.html"><a href="syllabus.html#who-should-take-this-course"><i class="fa fa-check"></i><b>2.2</b> Who Should Take This Course</a></li>
<li class="chapter" data-level="2.3" data-path="syllabus.html"><a href="syllabus.html#requirements-and-evaluation"><i class="fa fa-check"></i><b>2.3</b> Requirements and Evaluation</a></li>
<li class="chapter" data-level="2.4" data-path="syllabus.html"><a href="syllabus.html#activities-and-materials"><i class="fa fa-check"></i><b>2.4</b> Activities and Materials</a></li>
<li class="chapter" data-level="2.5" data-path="syllabus.html"><a href="syllabus.html#curriculum-outlineschedule"><i class="fa fa-check"></i><b>2.5</b> Curriculum Outline/Schedule</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>3</b> Installation</a><ul>
<li class="chapter" data-level="3.1" data-path="installation.html"><a href="installation.html#r"><i class="fa fa-check"></i><b>3.1</b> R</a></li>
<li class="chapter" data-level="3.2" data-path="installation.html"><a href="installation.html#rstudio"><i class="fa fa-check"></i><b>3.2</b> RStudio</a></li>
<li class="chapter" data-level="3.3" data-path="installation.html"><a href="installation.html#r-packages"><i class="fa fa-check"></i><b>3.3</b> R Packages</a></li>
<li class="chapter" data-level="3.4" data-path="installation.html"><a href="installation.html#latex"><i class="fa fa-check"></i><b>3.4</b> LaTeX</a></li>
<li class="chapter" data-level="3.5" data-path="installation.html"><a href="installation.html#git"><i class="fa fa-check"></i><b>3.5</b> Git</a></li>
<li class="chapter" data-level="3.6" data-path="installation.html"><a href="installation.html#google-chrome"><i class="fa fa-check"></i><b>3.6</b> Google Chrome</a></li>
<li class="chapter" data-level="3.7" data-path="installation.html"><a href="installation.html#selector-gadget"><i class="fa fa-check"></i><b>3.7</b> Selector Gadget</a></li>
<li class="chapter" data-level="3.8" data-path="installation.html"><a href="installation.html#other-helpful-tools"><i class="fa fa-check"></i><b>3.8</b> Other Helpful Tools</a></li>
<li class="chapter" data-level="3.9" data-path="installation.html"><a href="installation.html#troubleshooting"><i class="fa fa-check"></i><b>3.9</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="homework-rubric.html"><a href="homework-rubric.html"><i class="fa fa-check"></i><b>4</b> Homework Rubric</a></li>
<li class="part"><span><b>II Course Notes</b></span></li>
<li class="chapter" data-level="5" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>5</b> Introduction</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction.html"><a href="introduction.html#the-motivation"><i class="fa fa-check"></i><b>5.1</b> The Motivation</a></li>
<li class="chapter" data-level="5.2" data-path="introduction.html"><a href="introduction.html#about-this-class"><i class="fa fa-check"></i><b>5.2</b> About This Class</a></li>
<li class="chapter" data-level="5.3" data-path="introduction.html"><a href="introduction.html#learning-how-to-program"><i class="fa fa-check"></i><b>5.3</b> Learning How to Program</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>6</b> R Basics</a><ul>
<li class="chapter" data-level="6.1" data-path="r-basics.html"><a href="r-basics.html#what-is-r"><i class="fa fa-check"></i><b>6.1</b> What is R?</a></li>
<li class="chapter" data-level="6.2" data-path="r-basics.html"><a href="r-basics.html#rstudio-1"><i class="fa fa-check"></i><b>6.2</b> RStudio</a><ul>
<li class="chapter" data-level="6.2.1" data-path="r-basics.html"><a href="r-basics.html#console"><i class="fa fa-check"></i><b>6.2.1</b> Console</a></li>
<li class="chapter" data-level="6.2.2" data-path="r-basics.html"><a href="r-basics.html#scripts"><i class="fa fa-check"></i><b>6.2.2</b> Scripts</a></li>
<li class="chapter" data-level="6.2.3" data-path="r-basics.html"><a href="r-basics.html#running-code"><i class="fa fa-check"></i><b>6.2.3</b> Running Code</a></li>
<li class="chapter" data-level="6.2.4" data-path="r-basics.html"><a href="r-basics.html#comments"><i class="fa fa-check"></i><b>6.2.4</b> Comments</a></li>
<li class="chapter" data-level="6.2.5" data-path="r-basics.html"><a href="r-basics.html#diagnostics-and-errors"><i class="fa fa-check"></i><b>6.2.5</b> Diagnostics and errors</a></li>
<li class="chapter" data-level="6.2.6" data-path="r-basics.html"><a href="r-basics.html#errors-messages-and-warnings"><i class="fa fa-check"></i><b>6.2.6</b> Errors, Messages, and Warnings</a></li>
<li class="chapter" data-level="6.2.7" data-path="r-basics.html"><a href="r-basics.html#r-environment"><i class="fa fa-check"></i><b>6.2.7</b> R Environment</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="r-basics.html"><a href="r-basics.html#r-packages-1"><i class="fa fa-check"></i><b>6.3</b> R Packages</a><ul>
<li class="chapter" data-level="6.3.1" data-path="r-basics.html"><a href="r-basics.html#installing-packages"><i class="fa fa-check"></i><b>6.3.1</b> Installing Packages</a></li>
<li class="chapter" data-level="6.3.2" data-path="r-basics.html"><a href="r-basics.html#loading-packages"><i class="fa fa-check"></i><b>6.3.2</b> Loading Packages</a></li>
<li class="chapter" data-level="6.3.3" data-path="r-basics.html"><a href="r-basics.html#challenge"><i class="fa fa-check"></i><b>6.3.3</b> Challenge</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="r-basics.html"><a href="r-basics.html#r-markdown"><i class="fa fa-check"></i><b>6.4</b> R Markdown</a><ul>
<li class="chapter" data-level="6.4.1" data-path="r-basics.html"><a href="r-basics.html#yaml-header"><i class="fa fa-check"></i><b>6.4.1</b> YAML Header</a></li>
<li class="chapter" data-level="6.4.2" data-path="r-basics.html"><a href="r-basics.html#markdown"><i class="fa fa-check"></i><b>6.4.2</b> Markdown</a></li>
<li class="chapter" data-level="6.4.3" data-path="r-basics.html"><a href="r-basics.html#code-chunks"><i class="fa fa-check"></i><b>6.4.3</b> Code Chunks</a></li>
<li class="chapter" data-level="6.4.4" data-path="r-basics.html"><a href="r-basics.html#knitting"><i class="fa fa-check"></i><b>6.4.4</b> Knitting</a></li>
<li class="chapter" data-level="6.4.5" data-path="r-basics.html"><a href="r-basics.html#r-chunk-options-for-knitting"><i class="fa fa-check"></i><b>6.4.5</b> R Chunk Options for Knitting</a></li>
<li class="chapter" data-level="6.4.6" data-path="r-basics.html"><a href="r-basics.html#cheatsheets-and-other-resources"><i class="fa fa-check"></i><b>6.4.6</b> Cheatsheets and Other Resources</a></li>
<li class="chapter" data-level="6.4.7" data-path="r-basics.html"><a href="r-basics.html#challenges"><i class="fa fa-check"></i><b>6.4.7</b> Challenges</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-syntax.html"><a href="r-syntax.html"><i class="fa fa-check"></i><b>7</b> R Syntax</a><ul>
<li class="chapter" data-level="7.1" data-path="r-syntax.html"><a href="r-syntax.html#variables"><i class="fa fa-check"></i><b>7.1</b> Variables</a><ul>
<li class="chapter" data-level="7.1.1" data-path="r-syntax.html"><a href="r-syntax.html#arithmetic-operators"><i class="fa fa-check"></i><b>7.1.1</b> Arithmetic operators</a></li>
<li class="chapter" data-level="7.1.2" data-path="r-syntax.html"><a href="r-syntax.html#assigning-variables"><i class="fa fa-check"></i><b>7.1.2</b> Assigning Variables</a></li>
<li class="chapter" data-level="7.1.3" data-path="r-syntax.html"><a href="r-syntax.html#variable-names"><i class="fa fa-check"></i><b>7.1.3</b> Variable Names</a></li>
<li class="chapter" data-level="7.1.4" data-path="r-syntax.html"><a href="r-syntax.html#challenges-1"><i class="fa fa-check"></i><b>7.1.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="r-syntax.html"><a href="r-syntax.html#functions"><i class="fa fa-check"></i><b>7.2</b> Functions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="r-syntax.html"><a href="r-syntax.html#arguments"><i class="fa fa-check"></i><b>7.2.1</b> Arguments</a></li>
<li class="chapter" data-level="7.2.2" data-path="r-syntax.html"><a href="r-syntax.html#store-function-output"><i class="fa fa-check"></i><b>7.2.2</b> Store Function Output</a></li>
<li class="chapter" data-level="7.2.3" data-path="r-syntax.html"><a href="r-syntax.html#argument-restrictions-and-defaults"><i class="fa fa-check"></i><b>7.2.3</b> Argument Restrictions and Defaults</a></li>
<li class="chapter" data-level="7.2.4" data-path="r-syntax.html"><a href="r-syntax.html#documentation-and-help-files"><i class="fa fa-check"></i><b>7.2.4</b> Documentation and Help Files</a></li>
<li class="chapter" data-level="7.2.5" data-path="r-syntax.html"><a href="r-syntax.html#challenges-2"><i class="fa fa-check"></i><b>7.2.5</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="r-syntax.html"><a href="r-syntax.html#data-types"><i class="fa fa-check"></i><b>7.3</b> Data Types</a><ul>
<li class="chapter" data-level="7.3.1" data-path="r-syntax.html"><a href="r-syntax.html#what-is-that-type"><i class="fa fa-check"></i><b>7.3.1</b> What Is that Type?</a></li>
<li class="chapter" data-level="7.3.2" data-path="r-syntax.html"><a href="r-syntax.html#coercion"><i class="fa fa-check"></i><b>7.3.2</b> Coercion</a></li>
<li class="chapter" data-level="7.3.3" data-path="r-syntax.html"><a href="r-syntax.html#other-objects"><i class="fa fa-check"></i><b>7.3.3</b> Other Objects</a></li>
<li class="chapter" data-level="7.3.4" data-path="r-syntax.html"><a href="r-syntax.html#challenges-3"><i class="fa fa-check"></i><b>7.3.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="r-syntax.html"><a href="r-syntax.html#boolean-expressions"><i class="fa fa-check"></i><b>7.4</b> Boolean Expressions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="r-syntax.html"><a href="r-syntax.html#boolean-operators"><i class="fa fa-check"></i><b>7.4.1</b> Boolean Operators</a></li>
<li class="chapter" data-level="7.4.2" data-path="r-syntax.html"><a href="r-syntax.html#logical-operators"><i class="fa fa-check"></i><b>7.4.2</b> Logical Operators</a></li>
<li class="chapter" data-level="7.4.3" data-path="r-syntax.html"><a href="r-syntax.html#boolean-vectors"><i class="fa fa-check"></i><b>7.4.3</b> Boolean Vectors</a></li>
<li class="chapter" data-level="7.4.4" data-path="r-syntax.html"><a href="r-syntax.html#boolean-vectors-in-action"><i class="fa fa-check"></i><b>7.4.4</b> Boolean Vectors in Action</a></li>
<li class="chapter" data-level="7.4.5" data-path="r-syntax.html"><a href="r-syntax.html#challenges-4"><i class="fa fa-check"></i><b>7.4.5</b> Challenges</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="working-with-data.html"><a href="working-with-data.html"><i class="fa fa-check"></i><b>8</b> Working with Data</a><ul>
<li class="chapter" data-level="8.1" data-path="working-with-data.html"><a href="working-with-data.html#project-workflow"><i class="fa fa-check"></i><b>8.1</b> Project Workflow</a><ul>
<li class="chapter" data-level="8.1.1" data-path="working-with-data.html"><a href="working-with-data.html#store-analyses-in-scripts-not-workspaces"><i class="fa fa-check"></i><b>8.1.1</b> Store Analyses in Scripts, Not Workspaces</a></li>
<li class="chapter" data-level="8.1.2" data-path="working-with-data.html"><a href="working-with-data.html#working-directories-and-paths"><i class="fa fa-check"></i><b>8.1.2</b> Working Directories and Paths</a></li>
<li class="chapter" data-level="8.1.3" data-path="working-with-data.html"><a href="working-with-data.html#r-projects"><i class="fa fa-check"></i><b>8.1.3</b> R Projects</a></li>
<li class="chapter" data-level="8.1.4" data-path="working-with-data.html"><a href="working-with-data.html#file-organization"><i class="fa fa-check"></i><b>8.1.4</b> File Organization</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="working-with-data.html"><a href="working-with-data.html#importing-and-exporting"><i class="fa fa-check"></i><b>8.2</b> Importing and Exporting</a><ul>
<li class="chapter" data-level="8.2.1" data-path="working-with-data.html"><a href="working-with-data.html#where-is-my-data"><i class="fa fa-check"></i><b>8.2.1</b> Where Is My Data?</a></li>
<li class="chapter" data-level="8.2.2" data-path="working-with-data.html"><a href="working-with-data.html#data-storage"><i class="fa fa-check"></i><b>8.2.2</b> Data Storage</a></li>
<li class="chapter" data-level="8.2.3" data-path="working-with-data.html"><a href="working-with-data.html#importing-data"><i class="fa fa-check"></i><b>8.2.3</b> Importing Data</a></li>
<li class="chapter" data-level="8.2.4" data-path="working-with-data.html"><a href="working-with-data.html#exporting-data"><i class="fa fa-check"></i><b>8.2.4</b> Exporting Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>9</b> Data Transformation</a><ul>
<li class="chapter" data-level="9.1" data-path="data-transformation.html"><a href="data-transformation.html#introduction-to-data"><i class="fa fa-check"></i><b>9.1</b> Introduction to Data</a><ul>
<li class="chapter" data-level="9.1.1" data-path="data-transformation.html"><a href="data-transformation.html#the-gapminder-dataset"><i class="fa fa-check"></i><b>9.1.1</b> The Gapminder Dataset</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-transformation.html"><a href="data-transformation.html#structure-and-dimensions"><i class="fa fa-check"></i><b>9.1.2</b> Structure and Dimensions</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-transformation.html"><a href="data-transformation.html#variables-1"><i class="fa fa-check"></i><b>9.1.3</b> Variables</a></li>
<li class="chapter" data-level="9.1.4" data-path="data-transformation.html"><a href="data-transformation.html#challenges-5"><i class="fa fa-check"></i><b>9.1.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-transformation.html"><a href="data-transformation.html#introduction-to-dplyr"><i class="fa fa-check"></i><b>9.2</b> Introduction to <code>dplyr</code></a><ul>
<li class="chapter" data-level="9.2.1" data-path="data-transformation.html"><a href="data-transformation.html#tidyverse"><i class="fa fa-check"></i><b>9.2.1</b> <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="data-transformation.html"><a href="data-transformation.html#why-dplyr"><i class="fa fa-check"></i><b>9.2.2</b> Why <code>dplyr</code>?</a></li>
<li class="chapter" data-level="9.2.3" data-path="data-transformation.html"><a href="data-transformation.html#select-columns-with-select"><i class="fa fa-check"></i><b>9.2.3</b> Select Columns with <code>select</code></a></li>
<li class="chapter" data-level="9.2.4" data-path="data-transformation.html"><a href="data-transformation.html#the-pipe"><i class="fa fa-check"></i><b>9.2.4</b> The Pipe</a></li>
<li class="chapter" data-level="9.2.5" data-path="data-transformation.html"><a href="data-transformation.html#filter-rows-with-filter"><i class="fa fa-check"></i><b>9.2.5</b> Filter Rows with <code>filter</code></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-transformation.html"><a href="data-transformation.html#more-dplyr-functions"><i class="fa fa-check"></i><b>9.3</b> More <code>dplyr</code> functions</a><ul>
<li class="chapter" data-level="9.3.1" data-path="data-transformation.html"><a href="data-transformation.html#use-mutate-to-add-new-variables"><i class="fa fa-check"></i><b>9.3.1</b> Use <code>mutate()</code> to Add New Variables</a></li>
<li class="chapter" data-level="9.3.2" data-path="data-transformation.html"><a href="data-transformation.html#use-arrange-to-row-order-data-in-a-principled-way"><i class="fa fa-check"></i><b>9.3.2</b> Use <code>arrange()</code> to Row-order Data in a Principled Way</a></li>
<li class="chapter" data-level="9.3.3" data-path="data-transformation.html"><a href="data-transformation.html#use-rename-to-rename-variables"><i class="fa fa-check"></i><b>9.3.3</b> Use <code>rename()</code> to Rename Variables</a></li>
<li class="chapter" data-level="9.3.4" data-path="data-transformation.html"><a href="data-transformation.html#use-select-to-rename-and-reposition-variables"><i class="fa fa-check"></i><b>9.3.4</b> Use <code>select()</code> to Rename and Reposition Variables</a></li>
<li class="chapter" data-level="9.3.5" data-path="data-transformation.html"><a href="data-transformation.html#use-count-to-count-variable-quantities"><i class="fa fa-check"></i><b>9.3.5</b> Use <code>count()</code> to Count Variable Quantities</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="data-transformation.html"><a href="data-transformation.html#calculating-across-groups"><i class="fa fa-check"></i><b>9.4</b> Calculating across Groups</a><ul>
<li class="chapter" data-level="9.4.1" data-path="data-transformation.html"><a href="data-transformation.html#use-group_by-to-create-a-grouped-data"><i class="fa fa-check"></i><b>9.4.1</b> Use <code>group_by</code> to Create a Grouped Data</a></li>
<li class="chapter" data-level="9.4.2" data-path="data-transformation.html"><a href="data-transformation.html#summarize-across-groups-with-summarize"><i class="fa fa-check"></i><b>9.4.2</b> Summarize Across Groups with <code>summarize</code></a></li>
<li class="chapter" data-level="9.4.3" data-path="data-transformation.html"><a href="data-transformation.html#add-new-variables-with-mutate"><i class="fa fa-check"></i><b>9.4.3</b> Add New Variables with <code>mutate</code></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="data-transformation.html"><a href="data-transformation.html#challenges-6"><i class="fa fa-check"></i><b>9.5</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>10</b> Tidying Data</a><ul>
<li class="chapter" data-level="10.1" data-path="tidying-data.html"><a href="tidying-data.html#wide-vs.-long-formats"><i class="fa fa-check"></i><b>10.1</b> Wide vs. Long Formats</a></li>
<li class="chapter" data-level="10.2" data-path="tidying-data.html"><a href="tidying-data.html#tidying-the-gapminder-data"><i class="fa fa-check"></i><b>10.2</b> Tidying the Gapminder Data</a></li>
<li class="chapter" data-level="10.3" data-path="tidying-data.html"><a href="tidying-data.html#tidyr-functions"><i class="fa fa-check"></i><b>10.3</b> <code>tidyr</code> Functions</a><ul>
<li class="chapter" data-level="10.3.1" data-path="tidying-data.html"><a href="tidying-data.html#gather"><i class="fa fa-check"></i><b>10.3.1</b> <code>gather</code></a></li>
<li class="chapter" data-level="10.3.2" data-path="tidying-data.html"><a href="tidying-data.html#separate"><i class="fa fa-check"></i><b>10.3.2</b> <code>separate</code></a></li>
<li class="chapter" data-level="10.3.3" data-path="tidying-data.html"><a href="tidying-data.html#spread"><i class="fa fa-check"></i><b>10.3.3</b> <code>spread</code></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tidying-data.html"><a href="tidying-data.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>10.4</b> Dealing with Missing Data</a><ul>
<li class="chapter" data-level="10.4.1" data-path="tidying-data.html"><a href="tidying-data.html#na_if"><i class="fa fa-check"></i><b>10.4.1</b> <code>na_if</code></a></li>
<li class="chapter" data-level="10.4.2" data-path="tidying-data.html"><a href="tidying-data.html#replace-na-values-with-replace_na"><i class="fa fa-check"></i><b>10.4.2</b> Replace <code>NA</code> values with <code>replace_na</code></a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="tidying-data.html"><a href="tidying-data.html#more-tidyverse"><i class="fa fa-check"></i><b>10.5</b> More <code>tidyverse</code></a></li>
<li class="chapter" data-level="10.6" data-path="tidying-data.html"><a href="tidying-data.html#challenges-7"><i class="fa fa-check"></i><b>10.6</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>11</b> Relational Data</a><ul>
<li class="chapter" data-level="11.1" data-path="relational-data.html"><a href="relational-data.html#why-relational-data"><i class="fa fa-check"></i><b>11.1</b> Why Relational Data</a></li>
<li class="chapter" data-level="11.2" data-path="relational-data.html"><a href="relational-data.html#keys"><i class="fa fa-check"></i><b>11.2</b> Keys</a></li>
<li class="chapter" data-level="11.3" data-path="relational-data.html"><a href="relational-data.html#joins"><i class="fa fa-check"></i><b>11.3</b> Joins</a></li>
<li class="chapter" data-level="11.4" data-path="relational-data.html"><a href="relational-data.html#defining-keys"><i class="fa fa-check"></i><b>11.4</b> Defining Keys</a></li>
<li class="chapter" data-level="11.5" data-path="relational-data.html"><a href="relational-data.html#duplicate-keys"><i class="fa fa-check"></i><b>11.5</b> Duplicate Keys</a></li>
<li class="chapter" data-level="11.6" data-path="relational-data.html"><a href="relational-data.html#challenges-8"><i class="fa fa-check"></i><b>11.6</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>12</b> Plotting</a><ul>
<li class="chapter" data-level="12.1" data-path="plotting.html"><a href="plotting.html#the-dataset"><i class="fa fa-check"></i><b>12.1</b> The Dataset</a></li>
<li class="chapter" data-level="12.2" data-path="plotting.html"><a href="plotting.html#r-base-graphics"><i class="fa fa-check"></i><b>12.2</b> R Base Graphics</a><ul>
<li class="chapter" data-level="12.2.1" data-path="plotting.html"><a href="plotting.html#scatter-and-line-plots"><i class="fa fa-check"></i><b>12.2.1</b> Scatter and Line Plots</a></li>
<li class="chapter" data-level="12.2.2" data-path="plotting.html"><a href="plotting.html#histograms-and-density-plots"><i class="fa fa-check"></i><b>12.2.2</b> Histograms and Density Plots</a></li>
<li class="chapter" data-level="12.2.3" data-path="plotting.html"><a href="plotting.html#labels"><i class="fa fa-check"></i><b>12.2.3</b> Labels</a></li>
<li class="chapter" data-level="12.2.4" data-path="plotting.html"><a href="plotting.html#axis-and-size-scaling"><i class="fa fa-check"></i><b>12.2.4</b> Axis and Size Scaling</a></li>
<li class="chapter" data-level="12.2.5" data-path="plotting.html"><a href="plotting.html#graphical-parameters"><i class="fa fa-check"></i><b>12.2.5</b> Graphical Parameters</a></li>
<li class="chapter" data-level="12.2.6" data-path="plotting.html"><a href="plotting.html#annotations-reference-lines-and-legends"><i class="fa fa-check"></i><b>12.2.6</b> Annotations, Reference Lines, and Legends</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="plotting.html"><a href="plotting.html#ggplot2"><i class="fa fa-check"></i><b>12.3</b> ggplot2</a><ul>
<li class="chapter" data-level="12.3.1" data-path="plotting.html"><a href="plotting.html#grammar"><i class="fa fa-check"></i><b>12.3.1</b> Grammar</a></li>
<li class="chapter" data-level="12.3.2" data-path="plotting.html"><a href="plotting.html#anatomy-of-aes"><i class="fa fa-check"></i><b>12.3.2</b> Anatomy of <code>aes</code></a></li>
<li class="chapter" data-level="12.3.3" data-path="plotting.html"><a href="plotting.html#layers"><i class="fa fa-check"></i><b>12.3.3</b> Layers</a></li>
<li class="chapter" data-level="12.3.4" data-path="plotting.html"><a href="plotting.html#labels-1"><i class="fa fa-check"></i><b>12.3.4</b> Labels</a></li>
<li class="chapter" data-level="12.3.5" data-path="plotting.html"><a href="plotting.html#transformations-and-stats"><i class="fa fa-check"></i><b>12.3.5</b> Transformations and Stats</a></li>
<li class="chapter" data-level="12.3.6" data-path="plotting.html"><a href="plotting.html#facets"><i class="fa fa-check"></i><b>12.3.6</b> Facets</a></li>
<li class="chapter" data-level="12.3.7" data-path="plotting.html"><a href="plotting.html#legend-and-scale-manipulations"><i class="fa fa-check"></i><b>12.3.7</b> Legend and Scale Manipulations</a></li>
<li class="chapter" data-level="12.3.8" data-path="plotting.html"><a href="plotting.html#putting-everything-together"><i class="fa fa-check"></i><b>12.3.8</b> Putting Everything Together</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="plotting.html"><a href="plotting.html#saving-plots"><i class="fa fa-check"></i><b>12.4</b> Saving Plots</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="statistical-inferences.html"><a href="statistical-inferences.html"><i class="fa fa-check"></i><b>13</b> Statistical Inferences</a><ul>
<li class="chapter" data-level="13.1" data-path="statistical-inferences.html"><a href="statistical-inferences.html#statistical-distributions"><i class="fa fa-check"></i><b>13.1</b> Statistical Distributions</a><ul>
<li class="chapter" data-level="13.1.1" data-path="statistical-inferences.html"><a href="statistical-inferences.html#sampling-and-simulation"><i class="fa fa-check"></i><b>13.1.1</b> Sampling and Simulation</a></li>
<li class="chapter" data-level="13.1.2" data-path="statistical-inferences.html"><a href="statistical-inferences.html#random-seeds"><i class="fa fa-check"></i><b>13.1.2</b> Random Seeds</a></li>
<li class="chapter" data-level="13.1.3" data-path="statistical-inferences.html"><a href="statistical-inferences.html#challenges-9"><i class="fa fa-check"></i><b>13.1.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="statistical-inferences.html"><a href="statistical-inferences.html#inferences-and-regressions"><i class="fa fa-check"></i><b>13.2</b> Inferences and Regressions</a><ul>
<li class="chapter" data-level="13.2.1" data-path="statistical-inferences.html"><a href="statistical-inferences.html#statistical-tests"><i class="fa fa-check"></i><b>13.2.1</b> Statistical Tests</a></li>
<li class="chapter" data-level="13.2.2" data-path="statistical-inferences.html"><a href="statistical-inferences.html#regressions-and-linear-models"><i class="fa fa-check"></i><b>13.2.2</b> Regressions and Linear Models</a></li>
<li class="chapter" data-level="13.2.3" data-path="statistical-inferences.html"><a href="statistical-inferences.html#regression-output"><i class="fa fa-check"></i><b>13.2.3</b> Regression Output</a></li>
<li class="chapter" data-level="13.2.4" data-path="statistical-inferences.html"><a href="statistical-inferences.html#tidying-model-data-with-broom"><i class="fa fa-check"></i><b>13.2.4</b> Tidying model data with <code>broom</code></a></li>
<li class="chapter" data-level="13.2.5" data-path="statistical-inferences.html"><a href="statistical-inferences.html#formatting-regression-tables"><i class="fa fa-check"></i><b>13.2.5</b> Formatting Regression Tables</a></li>
<li class="chapter" data-level="13.2.6" data-path="statistical-inferences.html"><a href="statistical-inferences.html#challenges-10"><i class="fa fa-check"></i><b>13.2.6</b> Challenges</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html"><i class="fa fa-check"></i><b>14</b> Data Classes and Structures</a><ul>
<li class="chapter" data-level="14.1" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#vectors"><i class="fa fa-check"></i><b>14.1</b> Vectors</a><ul>
<li class="chapter" data-level="14.1.1" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#creating-vectors"><i class="fa fa-check"></i><b>14.1.1</b> Creating Vectors</a></li>
<li class="chapter" data-level="14.1.2" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#vectors-are-everywhere"><i class="fa fa-check"></i><b>14.1.2</b> Vectors Are Everywhere</a></li>
<li class="chapter" data-level="14.1.3" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#recycling"><i class="fa fa-check"></i><b>14.1.3</b> Recycling</a></li>
<li class="chapter" data-level="14.1.4" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#types-of-vectors"><i class="fa fa-check"></i><b>14.1.4</b> Types of Vectors</a></li>
<li class="chapter" data-level="14.1.5" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#coercion-1"><i class="fa fa-check"></i><b>14.1.5</b> Coercion</a></li>
<li class="chapter" data-level="14.1.6" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#naming-a-vector"><i class="fa fa-check"></i><b>14.1.6</b> Naming a Vector</a></li>
<li class="chapter" data-level="14.1.7" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#challenges-11"><i class="fa fa-check"></i><b>14.1.7</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#subsetting-vectors"><i class="fa fa-check"></i><b>14.2</b> Subsetting Vectors</a><ul>
<li class="chapter" data-level="14.2.1" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#subsetting-types"><i class="fa fa-check"></i><b>14.2.1</b> Subsetting Types</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#lists"><i class="fa fa-check"></i><b>14.3</b> Lists</a><ul>
<li class="chapter" data-level="14.3.1" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#creating-lists"><i class="fa fa-check"></i><b>14.3.1</b> Creating Lists</a></li>
<li class="chapter" data-level="14.3.2" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#naming-lists"><i class="fa fa-check"></i><b>14.3.2</b> Naming Lists</a></li>
<li class="chapter" data-level="14.3.3" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#list-structure"><i class="fa fa-check"></i><b>14.3.3</b> List Structure</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#subsetting-lists"><i class="fa fa-check"></i><b>14.4</b> Subsetting Lists</a><ul>
<li class="chapter" data-level="14.4.1" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#with"><i class="fa fa-check"></i><b>14.4.1</b> With <code>[</code></a></li>
<li class="chapter" data-level="14.4.2" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#with-1"><i class="fa fa-check"></i><b>14.4.2</b> With <code>[[</code></a></li>
<li class="chapter" data-level="14.4.3" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#with-2"><i class="fa fa-check"></i><b>14.4.3</b> with <code>$</code></a></li>
<li class="chapter" data-level="14.4.4" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#challenges-12"><i class="fa fa-check"></i><b>14.4.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#matrices"><i class="fa fa-check"></i><b>14.5</b> Matrices</a></li>
<li class="chapter" data-level="14.6" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#indexing-a-matrix"><i class="fa fa-check"></i><b>14.6</b> Indexing a Matrix</a></li>
<li class="chapter" data-level="14.7" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#dataframes"><i class="fa fa-check"></i><b>14.7</b> Dataframes</a><ul>
<li class="chapter" data-level="14.7.1" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#creating-dataframes"><i class="fa fa-check"></i><b>14.7.1</b> Creating Dataframes</a></li>
<li class="chapter" data-level="14.7.2" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#the-structure-of-dataframes"><i class="fa fa-check"></i><b>14.7.2</b> The Structure of Dataframes</a></li>
<li class="chapter" data-level="14.7.3" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#naming-dataframes"><i class="fa fa-check"></i><b>14.7.3</b> Naming Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#indexing-dataframes"><i class="fa fa-check"></i><b>14.8</b> Indexing Dataframes</a><ul>
<li class="chapter" data-level="14.8.1" data-path="data-classes-and-structures.html"><a href="data-classes-and-structures.html#challenges-13"><i class="fa fa-check"></i><b>14.8.1</b> Challenges</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html"><i class="fa fa-check"></i><b>15</b> Strings and Regular Expressions</a><ul>
<li class="chapter" data-level="15.1" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#string-basics"><i class="fa fa-check"></i><b>15.1</b> String Basics</a><ul>
<li class="chapter" data-level="15.1.1" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#creating-strings"><i class="fa fa-check"></i><b>15.1.1</b> Creating Strings</a></li>
<li class="chapter" data-level="15.1.2" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#escape-and-special-characters"><i class="fa fa-check"></i><b>15.1.2</b> Escape and Special Characters</a></li>
<li class="chapter" data-level="15.1.3" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#string-length"><i class="fa fa-check"></i><b>15.1.3</b> String Length</a></li>
<li class="chapter" data-level="15.1.4" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#combining-strings"><i class="fa fa-check"></i><b>15.1.4</b> Combining Strings</a></li>
<li class="chapter" data-level="15.1.5" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#subsetting-strings"><i class="fa fa-check"></i><b>15.1.5</b> Subsetting Strings</a></li>
<li class="chapter" data-level="15.1.6" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#locales"><i class="fa fa-check"></i><b>15.1.6</b> Locales</a></li>
<li class="chapter" data-level="15.1.7" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#challenges-14"><i class="fa fa-check"></i><b>15.1.7</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#regular-expressions"><i class="fa fa-check"></i><b>15.2</b> Regular Expressions</a><ul>
<li class="chapter" data-level="15.2.1" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#basic-matches"><i class="fa fa-check"></i><b>15.2.1</b> Basic Matches</a></li>
<li class="chapter" data-level="15.2.2" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#escape-characters"><i class="fa fa-check"></i><b>15.2.2</b> Escape Characters</a></li>
<li class="chapter" data-level="15.2.3" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#anchors"><i class="fa fa-check"></i><b>15.2.3</b> Anchors</a></li>
<li class="chapter" data-level="15.2.4" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#character-classes-and-alternatives"><i class="fa fa-check"></i><b>15.2.4</b> Character Classes and Alternatives</a></li>
<li class="chapter" data-level="15.2.5" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#repetition"><i class="fa fa-check"></i><b>15.2.5</b> Repetition</a></li>
<li class="chapter" data-level="15.2.6" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#regex-resources"><i class="fa fa-check"></i><b>15.2.6</b> Regex Resources</a></li>
<li class="chapter" data-level="15.2.7" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#challenges-15"><i class="fa fa-check"></i><b>15.2.7</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#common-tools"><i class="fa fa-check"></i><b>15.3</b> Common Tools</a><ul>
<li class="chapter" data-level="15.3.1" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#detect-matches"><i class="fa fa-check"></i><b>15.3.1</b> Detect Matches</a></li>
<li class="chapter" data-level="15.3.2" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#extract-matches"><i class="fa fa-check"></i><b>15.3.2</b> Extract Matches</a></li>
<li class="chapter" data-level="15.3.3" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#replacing-matches"><i class="fa fa-check"></i><b>15.3.3</b> Replacing Matches</a></li>
<li class="chapter" data-level="15.3.4" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#splitting"><i class="fa fa-check"></i><b>15.3.4</b> Splitting</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="strings-and-regular-expressions.html"><a href="strings-and-regular-expressions.html#other-types-of-patterns"><i class="fa fa-check"></i><b>15.4</b> Other Types of Patterns</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="programming-in-r.html"><a href="programming-in-r.html"><i class="fa fa-check"></i><b>16</b> Programming in R</a><ul>
<li class="chapter" data-level="16.1" data-path="programming-in-r.html"><a href="programming-in-r.html#conditional-flow"><i class="fa fa-check"></i><b>16.1</b> Conditional Flow</a><ul>
<li class="chapter" data-level="16.1.1" data-path="programming-in-r.html"><a href="programming-in-r.html#multiple-conditions"><i class="fa fa-check"></i><b>16.1.1</b> Multiple Conditions</a></li>
<li class="chapter" data-level="16.1.2" data-path="programming-in-r.html"><a href="programming-in-r.html#complex-statements"><i class="fa fa-check"></i><b>16.1.2</b> Complex Statements</a></li>
<li class="chapter" data-level="16.1.3" data-path="programming-in-r.html"><a href="programming-in-r.html#code-style"><i class="fa fa-check"></i><b>16.1.3</b> Code Style</a></li>
<li class="chapter" data-level="16.1.4" data-path="programming-in-r.html"><a href="programming-in-r.html#if-vs.-if_else"><i class="fa fa-check"></i><b>16.1.4</b> <code>if</code> vs. <code>if_else</code></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="programming-in-r.html"><a href="programming-in-r.html#functions-1"><i class="fa fa-check"></i><b>16.2</b> Functions</a><ul>
<li class="chapter" data-level="16.2.1" data-path="programming-in-r.html"><a href="programming-in-r.html#why-write-functions"><i class="fa fa-check"></i><b>16.2.1</b> Why Write Functions?</a></li>
<li class="chapter" data-level="16.2.2" data-path="programming-in-r.html"><a href="programming-in-r.html#anatomy-of-a-function"><i class="fa fa-check"></i><b>16.2.2</b> Anatomy of a Function</a></li>
<li class="chapter" data-level="16.2.3" data-path="programming-in-r.html"><a href="programming-in-r.html#writing-a-function"><i class="fa fa-check"></i><b>16.2.3</b> Writing a Function</a></li>
<li class="chapter" data-level="16.2.4" data-path="programming-in-r.html"><a href="programming-in-r.html#using-a-function"><i class="fa fa-check"></i><b>16.2.4</b> Using a Function</a></li>
<li class="chapter" data-level="16.2.5" data-path="programming-in-r.html"><a href="programming-in-r.html#challenges-16"><i class="fa fa-check"></i><b>16.2.5</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="programming-in-r.html"><a href="programming-in-r.html#iteration"><i class="fa fa-check"></i><b>16.3</b> Iteration</a><ul>
<li class="chapter" data-level="16.3.1" data-path="programming-in-r.html"><a href="programming-in-r.html#vectorized-functions"><i class="fa fa-check"></i><b>16.3.1</b> Vectorized Functions</a></li>
<li class="chapter" data-level="16.3.2" data-path="programming-in-r.html"><a href="programming-in-r.html#functional-programming-and-map"><i class="fa fa-check"></i><b>16.3.2</b> Functional Programming and <code>map</code></a></li>
<li class="chapter" data-level="16.3.3" data-path="programming-in-r.html"><a href="programming-in-r.html#challenges-17"><i class="fa fa-check"></i><b>16.3.3</b> Challenges</a></li>
<li class="chapter" data-level="16.3.4" data-path="programming-in-r.html"><a href="programming-in-r.html#scoped-verbs"><i class="fa fa-check"></i><b>16.3.4</b> Scoped Verbs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html"><i class="fa fa-check"></i><b>17</b> Collecting Data from the Web</a><ul>
<li class="chapter" data-level="17.1" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#introduction-1"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#web-apis"><i class="fa fa-check"></i><b>17.2</b> Web APIs</a><ul>
<li class="chapter" data-level="17.2.1" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#some-basic-terminology"><i class="fa fa-check"></i><b>17.2.1</b> Some Basic Terminology</a></li>
<li class="chapter" data-level="17.2.2" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#how-do-get-requests-work"><i class="fa fa-check"></i><b>17.2.2</b> How Do GET Requests Work?</a></li>
<li class="chapter" data-level="17.2.3" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#finding-apis"><i class="fa fa-check"></i><b>17.2.3</b> Finding APIs</a></li>
<li class="chapter" data-level="17.2.4" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#getting-api-access"><i class="fa fa-check"></i><b>17.2.4</b> Getting API Access</a></li>
<li class="chapter" data-level="17.2.5" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#using-apis-in-r"><i class="fa fa-check"></i><b>17.2.5</b> Using APIs in R</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#writing-api-queries"><i class="fa fa-check"></i><b>17.3</b> Writing API Queries</a><ul>
<li class="chapter" data-level="17.3.1" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#constructing-the-api-get-request"><i class="fa fa-check"></i><b>17.3.1</b> Constructing the API GET Request</a></li>
<li class="chapter" data-level="17.3.2" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#parsing-the-response"><i class="fa fa-check"></i><b>17.3.2</b> Parsing the Response</a></li>
<li class="chapter" data-level="17.3.3" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#iteration-through-results-pager"><i class="fa fa-check"></i><b>17.3.3</b> Iteration through Results Pager</a></li>
<li class="chapter" data-level="17.3.4" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#visualizing-results"><i class="fa fa-check"></i><b>17.3.4</b> Visualizing Results</a></li>
<li class="chapter" data-level="17.3.5" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#more-resources"><i class="fa fa-check"></i><b>17.3.5</b> More Resources</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#webscraping"><i class="fa fa-check"></i><b>17.4</b> Webscraping</a><ul>
<li class="chapter" data-level="17.4.1" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#what-is-a-website"><i class="fa fa-check"></i><b>17.4.1</b> What Is a Website?</a></li>
<li class="chapter" data-level="17.4.2" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#websites-return-html"><i class="fa fa-check"></i><b>17.4.2</b> Websites Return HTML</a></li>
<li class="chapter" data-level="17.4.3" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#html-elements"><i class="fa fa-check"></i><b>17.4.3</b> HTML Elements</a></li>
<li class="chapter" data-level="17.4.4" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#css"><i class="fa fa-check"></i><b>17.4.4</b> CSS</a></li>
<li class="chapter" data-level="17.4.5" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#finding-elements-with-selector-gadget"><i class="fa fa-check"></i><b>17.4.5</b> Finding Elements with Selector Gadget</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#scraping-presidential-statements"><i class="fa fa-check"></i><b>17.5</b> Scraping Presidential Statements</a><ul>
<li class="chapter" data-level="17.5.1" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#using-rvest-to-read-html"><i class="fa fa-check"></i><b>17.5.1</b> Using <code>RVest</code> to Read HTML</a></li>
<li class="chapter" data-level="17.5.2" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#find-page-elements"><i class="fa fa-check"></i><b>17.5.2</b> Find Page Elements</a></li>
<li class="chapter" data-level="17.5.3" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#get-attributes-and-text-of-elements"><i class="fa fa-check"></i><b>17.5.3</b> Get Attributes and Text of Elements</a></li>
<li class="chapter" data-level="17.5.4" data-path="collecting-data-from-the-web.html"><a href="collecting-data-from-the-web.html#lets-do-this"><i class="fa fa-check"></i><b>17.5.4</b> Let’s DO This</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>18</b> Text Analysis</a><ul>
<li class="chapter" data-level="18.1" data-path="text-analysis.html"><a href="text-analysis.html#preprocessing"><i class="fa fa-check"></i><b>18.1</b> Preprocessing</a><ul>
<li class="chapter" data-level="18.1.1" data-path="text-analysis.html"><a href="text-analysis.html#from-words-to-numbers"><i class="fa fa-check"></i><b>18.1.1</b> From Words to Numbers</a></li>
<li class="chapter" data-level="18.1.2" data-path="text-analysis.html"><a href="text-analysis.html#exploring-the-dtm"><i class="fa fa-check"></i><b>18.1.2</b> Exploring the DTM</a></li>
<li class="chapter" data-level="18.1.3" data-path="text-analysis.html"><a href="text-analysis.html#exporting-the-dtm"><i class="fa fa-check"></i><b>18.1.3</b> Exporting the DTM</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="text-analysis.html"><a href="text-analysis.html#sentiment-analysis-and-dictionary-methods"><i class="fa fa-check"></i><b>18.2</b> Sentiment Analysis and Dictionary Methods</a><ul>
<li class="chapter" data-level="18.2.1" data-path="text-analysis.html"><a href="text-analysis.html#preprocessing-and-setup"><i class="fa fa-check"></i><b>18.2.1</b> Preprocessing and Setup</a></li>
<li class="chapter" data-level="18.2.2" data-path="text-analysis.html"><a href="text-analysis.html#scoring-the-songs"><i class="fa fa-check"></i><b>18.2.2</b> Scoring the Songs</a></li>
<li class="chapter" data-level="18.2.3" data-path="text-analysis.html"><a href="text-analysis.html#challenges-18"><i class="fa fa-check"></i><b>18.2.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="text-analysis.html"><a href="text-analysis.html#distinctive-words"><i class="fa fa-check"></i><b>18.3</b> Distinctive Words</a><ul>
<li class="chapter" data-level="18.3.1" data-path="text-analysis.html"><a href="text-analysis.html#unique-usage"><i class="fa fa-check"></i><b>18.3.1</b> Unique Usage</a></li>
<li class="chapter" data-level="18.3.2" data-path="text-analysis.html"><a href="text-analysis.html#differences-in-frequencies"><i class="fa fa-check"></i><b>18.3.2</b> Differences in Frequencies</a></li>
<li class="chapter" data-level="18.3.3" data-path="text-analysis.html"><a href="text-analysis.html#differences-in-averages"><i class="fa fa-check"></i><b>18.3.3</b> Differences in Averages</a></li>
<li class="chapter" data-level="18.3.4" data-path="text-analysis.html"><a href="text-analysis.html#differences-in-averages-adjustment"><i class="fa fa-check"></i><b>18.3.4</b> Differences in Averages, Adjustment</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="text-analysis.html"><a href="text-analysis.html#structural-topic-models"><i class="fa fa-check"></i><b>18.4</b> Structural Topic Models</a><ul>
<li class="chapter" data-level="18.4.1" data-path="text-analysis.html"><a href="text-analysis.html#preprocessing-1"><i class="fa fa-check"></i><b>18.4.1</b> Preprocessing</a></li>
<li class="chapter" data-level="18.4.2" data-path="text-analysis.html"><a href="text-analysis.html#estimate-model"><i class="fa fa-check"></i><b>18.4.2</b> Estimate Model</a></li>
<li class="chapter" data-level="18.4.3" data-path="text-analysis.html"><a href="text-analysis.html#interpret-model"><i class="fa fa-check"></i><b>18.4.3</b> Interpret Model</a></li>
<li class="chapter" data-level="18.4.4" data-path="text-analysis.html"><a href="text-analysis.html#analyze-topics"><i class="fa fa-check"></i><b>18.4.4</b> Analyze Topics</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PLSC 31101: Computational Tools for Social Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="text-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 18</span> Text Analysis</h1>
<p>This unit focuses on computational text analysis (or “text-as-data”). We will explore:</p>
<ol style="list-style-type: decimal">
<li><strong>Preprocessing</strong> a corpus for common text analysis.</li>
<li><strong>Sentiment Analysis and Dictionary Methods</strong>, a simple, supervised method for classification.</li>
<li><strong>Distinctive Words</strong>, or word-separating techniques to compare corpora.</li>
<li><strong>Structural Topic Models</strong>, a popular unsupervised method for text exploration and analysis.</li>
</ol>
<p>These materials are based off a longer, week-long intensive workshop on computational text analysis. If you are interested in text-as-data, I would encourage you to work through these materials on your own: <a href="https://github.com/rochelleterman/FSUtext" class="uri">https://github.com/rochelleterman/FSUtext</a></p>
<div id="preprocessing" class="section level2">
<h2><span class="header-section-number">18.1</span> Preprocessing</h2>
<p>First let’s load our required packages:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="text-analysis.html#cb385-1"></a><span class="kw">library</span>(tm) <span class="co"># Framework for text mining</span></span>
<span id="cb385-2"><a href="text-analysis.html#cb385-2"></a><span class="kw">library</span>(tidyverse) <span class="co"># Data preparation and pipes %&gt;%</span></span>
<span id="cb385-3"><a href="text-analysis.html#cb385-3"></a><span class="kw">library</span>(ggplot2) <span class="co"># For plotting word frequencies</span></span>
<span id="cb385-4"><a href="text-analysis.html#cb385-4"></a><span class="kw">library</span>(wordcloud) <span class="co"># Wordclouds!</span></span></code></pre></div>
<p>A <strong>corpus</strong> is a collection of texts, usually stored electronically, and from which we perform our analysis. A corpus might be a collection of news articles from Reuters or the published works of Shakespeare.</p>
<p>Within each corpus we will have separate articles, stories, volumes, etc., each treated as a separate entity or record. Each unit is called a <strong>document</strong>.</p>
<p>For this unit, we will be using a section of Machiavelli’s Prince as our corpus. Since The Prince is a monograph, we have already “chunked” the text so that each short paragraph or “chunk” is considered a “document.”</p>
<div id="from-words-to-numbers" class="section level3">
<h3><span class="header-section-number">18.1.1</span> From Words to Numbers</h3>
<div id="corpus-readers" class="section level4 unnumbered">
<h4>Corpus Readers</h4>
<p>The <code>tm</code> package supports a variety of sources and formats. Run the code below to see what it includes.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="text-analysis.html#cb386-1"></a><span class="kw">getSources</span>()</span>
<span id="cb386-2"><a href="text-analysis.html#cb386-2"></a><span class="co">#&gt; [1] &quot;DataframeSource&quot; &quot;DirSource&quot;       &quot;URISource&quot;       &quot;VectorSource&quot;   </span></span>
<span id="cb386-3"><a href="text-analysis.html#cb386-3"></a><span class="co">#&gt; [5] &quot;XMLSource&quot;       &quot;ZipSource&quot;</span></span>
<span id="cb386-4"><a href="text-analysis.html#cb386-4"></a><span class="kw">getReaders</span>()</span>
<span id="cb386-5"><a href="text-analysis.html#cb386-5"></a><span class="co">#&gt;  [1] &quot;readDataframe&quot;           &quot;readDOC&quot;                </span></span>
<span id="cb386-6"><a href="text-analysis.html#cb386-6"></a><span class="co">#&gt;  [3] &quot;readPDF&quot;                 &quot;readPlain&quot;              </span></span>
<span id="cb386-7"><a href="text-analysis.html#cb386-7"></a><span class="co">#&gt;  [5] &quot;readRCV1&quot;                &quot;readRCV1asPlain&quot;        </span></span>
<span id="cb386-8"><a href="text-analysis.html#cb386-8"></a><span class="co">#&gt;  [7] &quot;readReut21578XML&quot;        &quot;readReut21578XMLasPlain&quot;</span></span>
<span id="cb386-9"><a href="text-analysis.html#cb386-9"></a><span class="co">#&gt;  [9] &quot;readTagged&quot;              &quot;readXML&quot;</span></span></code></pre></div>
<p>Here we will be reading documents from a CSV file in which each row is a document that includes columns for text and metadata (information about each document). This is the easiest option if you have metadata.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="text-analysis.html#cb387-1"></a>docs.df &lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/mach.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>) <span class="co"># Read in CSV file</span></span>
<span id="cb387-2"><a href="text-analysis.html#cb387-2"></a>docs.df &lt;-<span class="st"> </span>docs.df <span class="op">%&gt;%</span></span>
<span id="cb387-3"><a href="text-analysis.html#cb387-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">text =</span> <span class="kw">str_conv</span>(text, <span class="st">&quot;UTF-8&quot;</span>))</span>
<span id="cb387-4"><a href="text-analysis.html#cb387-4"></a>docs &lt;-<span class="st"> </span><span class="kw">Corpus</span>(<span class="kw">VectorSource</span>(docs.df<span class="op">$</span>text))</span>
<span id="cb387-5"><a href="text-analysis.html#cb387-5"></a>docs</span>
<span id="cb387-6"><a href="text-analysis.html#cb387-6"></a><span class="co">#&gt; &lt;&lt;SimpleCorpus&gt;&gt;</span></span>
<span id="cb387-7"><a href="text-analysis.html#cb387-7"></a><span class="co">#&gt; Metadata:  corpus specific: 1, document level (indexed): 0</span></span>
<span id="cb387-8"><a href="text-analysis.html#cb387-8"></a><span class="co">#&gt; Content:  documents: 188</span></span></code></pre></div>
<p>Once we have the corpus, we can inspect the documents using <code>inspect()</code>.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="text-analysis.html#cb388-1"></a><span class="co"># See the 16th document</span></span>
<span id="cb388-2"><a href="text-analysis.html#cb388-2"></a><span class="kw">inspect</span>(docs[<span class="dv">16</span>])</span>
<span id="cb388-3"><a href="text-analysis.html#cb388-3"></a><span class="co">#&gt; &lt;&lt;SimpleCorpus&gt;&gt;</span></span>
<span id="cb388-4"><a href="text-analysis.html#cb388-4"></a><span class="co">#&gt; Metadata:  corpus specific: 1, document level (indexed): 0</span></span>
<span id="cb388-5"><a href="text-analysis.html#cb388-5"></a><span class="co">#&gt; Content:  documents: 1</span></span>
<span id="cb388-6"><a href="text-analysis.html#cb388-6"></a><span class="co">#&gt; </span></span>
<span id="cb388-7"><a href="text-analysis.html#cb388-7"></a><span class="co">#&gt; [1]  Therefore, since a ruler cannot both practise this virtue of generosity and be known to do so without harming himself, he would do well not to worry about being called miserly. For eventually he will come to be considered more generous, when it is realised that, because of his parsimony, his revenues are sufficient to defend himself against any enemies that attack him, and to undertake campaigns without imposing special taxes on the people. Thus he will be acting generously towards the vast majority, whose property he does not touch, and will be acting meanly towards the few to whom he gives nothing.  Those rulers who have achieved great things in our own times have all been considered mean; all the others have failed. Although Pope Julius II cultivated a reputation for generosity in order to become pope, he did not seek to maintain it afterwards, because he wanted to be</span></span></code></pre></div>
</div>
<div id="preprocessing-functions" class="section level4 unnumbered">
<h4>Preprocessing Functions</h4>
<p>Many text analysis applications follow a similar ‘recipe’ for preprocessing, involving (the order of these steps might differ as per application)</p>
<ol style="list-style-type: decimal">
<li>Tokenizing the text to unigrams (or bigrams, or trigrams).</li>
<li>Converting all characters to lowercase.</li>
<li>Removing punctuation.</li>
<li>Removing numbers.</li>
<li>Removing Stop Words, inclugind custom stop words.</li>
<li>“Stemming” words, or lemmitization. There are several stemming algorithms. Porter is the most popular.</li>
<li>Creating a Document-Term Matrix.</li>
</ol>
<p><code>tm</code> lets us convert a corpus to a DTM while completing the pre-processing steps in one step.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="text-analysis.html#cb389-1"></a>dtm &lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(docs,</span>
<span id="cb389-2"><a href="text-analysis.html#cb389-2"></a>           <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">stopwords =</span> <span class="ot">TRUE</span>,</span>
<span id="cb389-3"><a href="text-analysis.html#cb389-3"></a>                          <span class="dt">tolower =</span> <span class="ot">TRUE</span>,</span>
<span id="cb389-4"><a href="text-analysis.html#cb389-4"></a>                          <span class="dt">removeNumbers =</span> <span class="ot">TRUE</span>,</span>
<span id="cb389-5"><a href="text-analysis.html#cb389-5"></a>                          <span class="dt">removePunctuation =</span> <span class="ot">TRUE</span>,</span>
<span id="cb389-6"><a href="text-analysis.html#cb389-6"></a>                          <span class="dt">stemming=</span><span class="ot">TRUE</span>))</span></code></pre></div>
</div>
<div id="weighting" class="section level4 unnumbered">
<h4>Weighting</h4>
<p>One common pre-processing step that some applications may call for is applying tf-idf weights. The <a href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf">tf-idf</a>, or term frequency-inverse document frequency, is a weight that ranks the importance of a term in its contextual document corpus. The tf-idf value increases proportionally to the number of times a word appears in the document, but is offset by the frequency of the word in the corpus, which helps to adjust for the fact that some words appear more frequently in general. In other words, it places importance on terms frequent in the document but rare in the corpus.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="text-analysis.html#cb390-1"></a>dtm.weighted &lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(docs,</span>
<span id="cb390-2"><a href="text-analysis.html#cb390-2"></a>           <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">weighting =</span><span class="cf">function</span>(x) <span class="kw">weightTfIdf</span>(x, <span class="dt">normalize =</span> <span class="ot">TRUE</span>),</span>
<span id="cb390-3"><a href="text-analysis.html#cb390-3"></a>                          <span class="dt">stopwords =</span> <span class="ot">TRUE</span>,</span>
<span id="cb390-4"><a href="text-analysis.html#cb390-4"></a>                          <span class="dt">tolower =</span> <span class="ot">TRUE</span>,</span>
<span id="cb390-5"><a href="text-analysis.html#cb390-5"></a>                          <span class="dt">removeNumbers =</span> <span class="ot">TRUE</span>,</span>
<span id="cb390-6"><a href="text-analysis.html#cb390-6"></a>                          <span class="dt">removePunctuation =</span> <span class="ot">TRUE</span>,</span>
<span id="cb390-7"><a href="text-analysis.html#cb390-7"></a>                          <span class="dt">stemming=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<p>Compare the first 5 rows and 5 columns of the <code>dtm</code> and <code>dtm.weighted</code>. What do you notice?</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="text-analysis.html#cb391-1"></a><span class="kw">inspect</span>(dtm[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb391-2"><a href="text-analysis.html#cb391-2"></a><span class="co">#&gt; &lt;&lt;DocumentTermMatrix (documents: 5, terms: 5)&gt;&gt;</span></span>
<span id="cb391-3"><a href="text-analysis.html#cb391-3"></a><span class="co">#&gt; Non-/sparse entries: 3/22</span></span>
<span id="cb391-4"><a href="text-analysis.html#cb391-4"></a><span class="co">#&gt; Sparsity           : 88%</span></span>
<span id="cb391-5"><a href="text-analysis.html#cb391-5"></a><span class="co">#&gt; Maximal term length: 7</span></span>
<span id="cb391-6"><a href="text-analysis.html#cb391-6"></a><span class="co">#&gt; Weighting          : term frequency (tf)</span></span>
<span id="cb391-7"><a href="text-analysis.html#cb391-7"></a><span class="co">#&gt; Sample             :</span></span>
<span id="cb391-8"><a href="text-analysis.html#cb391-8"></a><span class="co">#&gt;     Terms</span></span>
<span id="cb391-9"><a href="text-analysis.html#cb391-9"></a><span class="co">#&gt; Docs abandon abil abject abl ablest</span></span>
<span id="cb391-10"><a href="text-analysis.html#cb391-10"></a><span class="co">#&gt;    1       0    0      0   0      0</span></span>
<span id="cb391-11"><a href="text-analysis.html#cb391-11"></a><span class="co">#&gt;    2       0    1      0   0      0</span></span>
<span id="cb391-12"><a href="text-analysis.html#cb391-12"></a><span class="co">#&gt;    3       0    0      0   0      0</span></span>
<span id="cb391-13"><a href="text-analysis.html#cb391-13"></a><span class="co">#&gt;    4       0    1      0   1      0</span></span>
<span id="cb391-14"><a href="text-analysis.html#cb391-14"></a><span class="co">#&gt;    5       0    0      0   0      0</span></span>
<span id="cb391-15"><a href="text-analysis.html#cb391-15"></a><span class="kw">inspect</span>(dtm.weighted[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb391-16"><a href="text-analysis.html#cb391-16"></a><span class="co">#&gt; &lt;&lt;DocumentTermMatrix (documents: 5, terms: 5)&gt;&gt;</span></span>
<span id="cb391-17"><a href="text-analysis.html#cb391-17"></a><span class="co">#&gt; Non-/sparse entries: 3/22</span></span>
<span id="cb391-18"><a href="text-analysis.html#cb391-18"></a><span class="co">#&gt; Sparsity           : 88%</span></span>
<span id="cb391-19"><a href="text-analysis.html#cb391-19"></a><span class="co">#&gt; Maximal term length: 7</span></span>
<span id="cb391-20"><a href="text-analysis.html#cb391-20"></a><span class="co">#&gt; Weighting          : term frequency - inverse document frequency (normalized) (tf-idf)</span></span>
<span id="cb391-21"><a href="text-analysis.html#cb391-21"></a><span class="co">#&gt; Sample             :</span></span>
<span id="cb391-22"><a href="text-analysis.html#cb391-22"></a><span class="co">#&gt;     Terms</span></span>
<span id="cb391-23"><a href="text-analysis.html#cb391-23"></a><span class="co">#&gt; Docs abandon   abil abject    abl ablest</span></span>
<span id="cb391-24"><a href="text-analysis.html#cb391-24"></a><span class="co">#&gt;    1       0 0.0000      0 0.0000      0</span></span>
<span id="cb391-25"><a href="text-analysis.html#cb391-25"></a><span class="co">#&gt;    2       0 0.0402      0 0.0000      0</span></span>
<span id="cb391-26"><a href="text-analysis.html#cb391-26"></a><span class="co">#&gt;    3       0 0.0000      0 0.0000      0</span></span>
<span id="cb391-27"><a href="text-analysis.html#cb391-27"></a><span class="co">#&gt;    4       0 0.0310      0 0.0228      0</span></span>
<span id="cb391-28"><a href="text-analysis.html#cb391-28"></a><span class="co">#&gt;    5       0 0.0000      0 0.0000      0</span></span></code></pre></div>
</div>
</div>
<div id="exploring-the-dtm" class="section level3">
<h3><span class="header-section-number">18.1.2</span> Exploring the DTM</h3>
<div id="dimensions" class="section level4 unnumbered">
<h4>Dimensions</h4>
<p>Let’s look at the structure of our DTM. Print the dimensions of the DTM. How many documents do we have? How many terms?</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="text-analysis.html#cb392-1"></a><span class="co"># How many documents? How many terms?</span></span>
<span id="cb392-2"><a href="text-analysis.html#cb392-2"></a><span class="kw">dim</span>(dtm)</span>
<span id="cb392-3"><a href="text-analysis.html#cb392-3"></a><span class="co">#&gt; [1]  188 2368</span></span></code></pre></div>
</div>
<div id="frequencies" class="section level4 unnumbered">
<h4>Frequencies</h4>
<p>We can obtain the term frequencies as a vector by converting the document term matrix into a matrix and using <code>colSums</code> to sum the column counts.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="text-analysis.html#cb393-1"></a><span class="co"># How many terms?</span></span>
<span id="cb393-2"><a href="text-analysis.html#cb393-2"></a>freq &lt;-<span class="st"> </span><span class="kw">colSums</span>(<span class="kw">as.matrix</span>(dtm))</span>
<span id="cb393-3"><a href="text-analysis.html#cb393-3"></a>freq[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb393-4"><a href="text-analysis.html#cb393-4"></a><span class="co">#&gt; abandon    abil  abject     abl  ablest </span></span>
<span id="cb393-5"><a href="text-analysis.html#cb393-5"></a><span class="co">#&gt;       4      35       1      61       1</span></span>
<span id="cb393-6"><a href="text-analysis.html#cb393-6"></a><span class="kw">length</span>(freq)</span>
<span id="cb393-7"><a href="text-analysis.html#cb393-7"></a><span class="co">#&gt; [1] 2368</span></span></code></pre></div>
<p>By ordering the frequencies, we can list the most frequent terms and the least frequent terms.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="text-analysis.html#cb394-1"></a><span class="co"># Order</span></span>
<span id="cb394-2"><a href="text-analysis.html#cb394-2"></a>sorted &lt;-<span class="st"> </span><span class="kw">sort</span>(freq, <span class="dt">decreasing =</span> T)</span>
<span id="cb394-3"><a href="text-analysis.html#cb394-3"></a></span>
<span id="cb394-4"><a href="text-analysis.html#cb394-4"></a><span class="co"># Most frequent terms</span></span>
<span id="cb394-5"><a href="text-analysis.html#cb394-5"></a><span class="kw">head</span>(sorted)</span>
<span id="cb394-6"><a href="text-analysis.html#cb394-6"></a><span class="co">#&gt; ruler  will power   one peopl alway </span></span>
<span id="cb394-7"><a href="text-analysis.html#cb394-7"></a><span class="co">#&gt;   280   251   169   168    98    95</span></span>
<span id="cb394-8"><a href="text-analysis.html#cb394-8"></a></span>
<span id="cb394-9"><a href="text-analysis.html#cb394-9"></a><span class="co"># Least frequent</span></span>
<span id="cb394-10"><a href="text-analysis.html#cb394-10"></a><span class="kw">tail</span>(sorted)</span>
<span id="cb394-11"><a href="text-analysis.html#cb394-11"></a><span class="co">#&gt;  xxiv   xxv  xxvi yield  yoke youth </span></span>
<span id="cb394-12"><a href="text-analysis.html#cb394-12"></a><span class="co">#&gt;     1     1     1     1     1     1</span></span></code></pre></div>
</div>
<div id="plotting-frequencies" class="section level4 unnumbered">
<h4>Plotting Frequencies</h4>
<p>Let’s make a plot that shows the frequency of frequencies for the terms. (For example, how many words are used only once? 5 times? 10 times?)</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="text-analysis.html#cb395-1"></a><span class="co"># Frequency of frenquencies</span></span>
<span id="cb395-2"><a href="text-analysis.html#cb395-2"></a><span class="kw">head</span>(<span class="kw">table</span>(freq),<span class="dv">15</span>)</span>
<span id="cb395-3"><a href="text-analysis.html#cb395-3"></a><span class="co">#&gt; freq</span></span>
<span id="cb395-4"><a href="text-analysis.html#cb395-4"></a><span class="co">#&gt;   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15 </span></span>
<span id="cb395-5"><a href="text-analysis.html#cb395-5"></a><span class="co">#&gt; 988 363 202 140 103  73  55  39  33  29  24  22  20  20  19</span></span>
<span id="cb395-6"><a href="text-analysis.html#cb395-6"></a><span class="kw">tail</span>(<span class="kw">table</span>(freq),<span class="dv">15</span>)</span>
<span id="cb395-7"><a href="text-analysis.html#cb395-7"></a><span class="co">#&gt; freq</span></span>
<span id="cb395-8"><a href="text-analysis.html#cb395-8"></a><span class="co">#&gt;  65  68  70  71  73  74  75  76  77  95  98 168 169 251 280 </span></span>
<span id="cb395-9"><a href="text-analysis.html#cb395-9"></a><span class="co">#&gt;   1   1   1   1   2   1   1   1   1   2   1   1   1   1   1</span></span>
<span id="cb395-10"><a href="text-analysis.html#cb395-10"></a></span>
<span id="cb395-11"><a href="text-analysis.html#cb395-11"></a><span class="co"># Plot</span></span>
<span id="cb395-12"><a href="text-analysis.html#cb395-12"></a><span class="kw">plot</span>(<span class="kw">table</span>(freq))</span></code></pre></div>
<p><img src="plsc31101_files/figure-html/unnamed-chunk-461-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>What does this tell us about the nature of language?</p>
</div>
<div id="exploring-common-words" class="section level4 unnumbered">
<h4>Exploring Common Words</h4>
<p>The <code>tm</code> package has lots of useful functions to help you explore common words and associations:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="text-analysis.html#cb396-1"></a><span class="co"># Have a look at common words</span></span>
<span id="cb396-2"><a href="text-analysis.html#cb396-2"></a><span class="kw">findFreqTerms</span>(dtm, <span class="dt">lowfreq=</span><span class="dv">50</span>) <span class="co"># Words that appear at least 50 times</span></span>
<span id="cb396-3"><a href="text-analysis.html#cb396-3"></a><span class="co">#&gt;  [1] &quot;abl&quot;      &quot;act&quot;      &quot;alway&quot;    &quot;armi&quot;     &quot;becom&quot;    &quot;can&quot;     </span></span>
<span id="cb396-4"><a href="text-analysis.html#cb396-4"></a><span class="co">#&gt;  [7] &quot;consid&quot;   &quot;either&quot;   &quot;forc&quot;     &quot;great&quot;    &quot;king&quot;     &quot;maintain&quot;</span></span>
<span id="cb396-5"><a href="text-analysis.html#cb396-5"></a><span class="co">#&gt; [13] &quot;make&quot;     &quot;man&quot;      &quot;mani&quot;     &quot;men&quot;      &quot;much&quot;     &quot;must&quot;    </span></span>
<span id="cb396-6"><a href="text-analysis.html#cb396-6"></a><span class="co">#&gt; [19] &quot;never&quot;    &quot;new&quot;      &quot;one&quot;      &quot;order&quot;    &quot;other&quot;    &quot;peopl&quot;   </span></span>
<span id="cb396-7"><a href="text-analysis.html#cb396-7"></a><span class="co">#&gt; [25] &quot;power&quot;    &quot;reason&quot;   &quot;ruler&quot;    &quot;sinc&quot;     &quot;state&quot;    &quot;subject&quot; </span></span>
<span id="cb396-8"><a href="text-analysis.html#cb396-8"></a><span class="co">#&gt; [31] &quot;time&quot;     &quot;troop&quot;    &quot;use&quot;      &quot;want&quot;     &quot;way&quot;      &quot;well&quot;    </span></span>
<span id="cb396-9"><a href="text-analysis.html#cb396-9"></a><span class="co">#&gt; [37] &quot;will&quot;</span></span>
<span id="cb396-10"><a href="text-analysis.html#cb396-10"></a></span>
<span id="cb396-11"><a href="text-analysis.html#cb396-11"></a><span class="co"># Which words correlate with &quot;war&quot;?</span></span>
<span id="cb396-12"><a href="text-analysis.html#cb396-12"></a><span class="kw">findAssocs</span>(dtm, <span class="st">&quot;war&quot;</span>, <span class="fl">0.3</span>)</span>
<span id="cb396-13"><a href="text-analysis.html#cb396-13"></a><span class="co">#&gt; $war</span></span>
<span id="cb396-14"><a href="text-analysis.html#cb396-14"></a><span class="co">#&gt;     wage    fight  antioch     argu     brew    induc      lip    maxim </span></span>
<span id="cb396-15"><a href="text-analysis.html#cb396-15"></a><span class="co">#&gt;     0.73     0.52     0.45     0.45     0.45     0.45     0.45     0.45 </span></span>
<span id="cb396-16"><a href="text-analysis.html#cb396-16"></a><span class="co">#&gt;  relianc     sage    trifl  postpon     mere     evil    avoid     flee </span></span>
<span id="cb396-17"><a href="text-analysis.html#cb396-17"></a><span class="co">#&gt;     0.45     0.45     0.45     0.41     0.35     0.34     0.32     0.32 </span></span>
<span id="cb396-18"><a href="text-analysis.html#cb396-18"></a><span class="co">#&gt;   occupi     glad glorious    heard     hunt ineffect     knew   produc </span></span>
<span id="cb396-19"><a href="text-analysis.html#cb396-19"></a><span class="co">#&gt;     0.32     0.30     0.30     0.30     0.30     0.30     0.30     0.30 </span></span>
<span id="cb396-20"><a href="text-analysis.html#cb396-20"></a><span class="co">#&gt; temporis </span></span>
<span id="cb396-21"><a href="text-analysis.html#cb396-21"></a><span class="co">#&gt;     0.30</span></span></code></pre></div>
<p>We can even make wordclouds showing the most commons terms:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="text-analysis.html#cb397-1"></a><span class="co"># Wordclouds!</span></span>
<span id="cb397-2"><a href="text-analysis.html#cb397-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb397-3"><a href="text-analysis.html#cb397-3"></a><span class="kw">wordcloud</span>(<span class="kw">names</span>(sorted), sorted, <span class="dt">max.words=</span><span class="dv">100</span>, <span class="dt">colors=</span><span class="kw">brewer.pal</span>(<span class="dv">6</span>,<span class="st">&quot;Dark2&quot;</span>))</span>
<span id="cb397-4"><a href="text-analysis.html#cb397-4"></a><span class="co">#&gt; Warning in wordcloud(names(sorted), sorted, max.words = 100, colors =</span></span>
<span id="cb397-5"><a href="text-analysis.html#cb397-5"></a><span class="co">#&gt; brewer.pal(6, : ruler could not be fit on page. It will not be plotted.</span></span>
<span id="cb397-6"><a href="text-analysis.html#cb397-6"></a><span class="co">#&gt; Warning in wordcloud(names(sorted), sorted, max.words = 100, colors =</span></span>
<span id="cb397-7"><a href="text-analysis.html#cb397-7"></a><span class="co">#&gt; brewer.pal(6, : power could not be fit on page. It will not be plotted.</span></span></code></pre></div>
<p><img src="plsc31101_files/figure-html/unnamed-chunk-463-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="removing-sparse-terms" class="section level4 unnumbered">
<h4>Removing Sparse Terms</h4>
<p>Somtimes we want to remove sparse terms and, thus, increase efficency. Look up the help file for the function <code>removeSparseTerms</code>. Using this function, create an object called <code>dtm.s</code> that contains only terms with &lt;.9 sparsity (meaning they appear in more than 10% of documents).</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="text-analysis.html#cb398-1"></a>dtm.s &lt;-<span class="st"> </span><span class="kw">removeSparseTerms</span>(dtm,.<span class="dv">9</span>)</span>
<span id="cb398-2"><a href="text-analysis.html#cb398-2"></a>dtm </span>
<span id="cb398-3"><a href="text-analysis.html#cb398-3"></a><span class="co">#&gt; &lt;&lt;DocumentTermMatrix (documents: 188, terms: 2368)&gt;&gt;</span></span>
<span id="cb398-4"><a href="text-analysis.html#cb398-4"></a><span class="co">#&gt; Non-/sparse entries: 11754/433430</span></span>
<span id="cb398-5"><a href="text-analysis.html#cb398-5"></a><span class="co">#&gt; Sparsity           : 97%</span></span>
<span id="cb398-6"><a href="text-analysis.html#cb398-6"></a><span class="co">#&gt; Maximal term length: 15</span></span>
<span id="cb398-7"><a href="text-analysis.html#cb398-7"></a><span class="co">#&gt; Weighting          : term frequency (tf)</span></span>
<span id="cb398-8"><a href="text-analysis.html#cb398-8"></a>dtm.s </span>
<span id="cb398-9"><a href="text-analysis.html#cb398-9"></a><span class="co">#&gt; &lt;&lt;DocumentTermMatrix (documents: 188, terms: 136)&gt;&gt;</span></span>
<span id="cb398-10"><a href="text-analysis.html#cb398-10"></a><span class="co">#&gt; Non-/sparse entries: 4353/21215</span></span>
<span id="cb398-11"><a href="text-analysis.html#cb398-11"></a><span class="co">#&gt; Sparsity           : 83%</span></span>
<span id="cb398-12"><a href="text-analysis.html#cb398-12"></a><span class="co">#&gt; Maximal term length: 12</span></span>
<span id="cb398-13"><a href="text-analysis.html#cb398-13"></a><span class="co">#&gt; Weighting          : term frequency (tf)</span></span></code></pre></div>
</div>
</div>
<div id="exporting-the-dtm" class="section level3">
<h3><span class="header-section-number">18.1.3</span> Exporting the DTM</h3>
<p>We can convert a DTM to a matrix or dataframe in order to write it to a CSV, add metadata, etc.</p>
<p>First, create an object that converts the DTM to a dataframe (we first have to convert it to a matrix and then to a dataframe):</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="text-analysis.html#cb399-1"></a><span class="co"># Coerce into dataframe</span></span>
<span id="cb399-2"><a href="text-analysis.html#cb399-2"></a>dtm &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">as.matrix</span>(dtm))</span>
<span id="cb399-3"><a href="text-analysis.html#cb399-3"></a><span class="kw">names</span>(dtm)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]  <span class="co"># Names of documents</span></span>
<span id="cb399-4"><a href="text-analysis.html#cb399-4"></a><span class="co">#&gt;  [1] &quot;abandon&quot;   &quot;abil&quot;      &quot;abject&quot;    &quot;abl&quot;       &quot;ablest&quot;    &quot;abovement&quot;</span></span>
<span id="cb399-5"><a href="text-analysis.html#cb399-5"></a><span class="co">#&gt;  [7] &quot;abovenam&quot;  &quot;absolut&quot;   &quot;absorb&quot;    &quot;accept&quot;</span></span>
<span id="cb399-6"><a href="text-analysis.html#cb399-6"></a></span>
<span id="cb399-7"><a href="text-analysis.html#cb399-7"></a><span class="co"># Write CSV</span></span>
<span id="cb399-8"><a href="text-analysis.html#cb399-8"></a><span class="co"># write.csv(dtm, &quot;dtm.csv&quot;, row.names = F)</span></span></code></pre></div>
<div id="challenge.-1" class="section level4">
<h4><span class="header-section-number">18.1.3.1</span> Challenge.</h4>
<p>Using one of the datasets in the <code>data</code> directory, create a document term matrix and a wordcloud of the most common terms.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="text-analysis.html#cb400-1"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>

</div>
</div>
</div>
<div id="sentiment-analysis-and-dictionary-methods" class="section level2">
<h2><span class="header-section-number">18.2</span> Sentiment Analysis and Dictionary Methods</h2>
<p>To demonstrate sentiment analysis, we are going to explore lyrics from Taylor Swift songs.</p>
<p>Road the code below to get started:</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="text-analysis.html#cb401-1"></a><span class="kw">require</span>(tm)</span>
<span id="cb401-2"><a href="text-analysis.html#cb401-2"></a><span class="kw">require</span>(tidytext)</span>
<span id="cb401-3"><a href="text-analysis.html#cb401-3"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb401-4"><a href="text-analysis.html#cb401-4"></a><span class="kw">require</span>(stringr)</span>
<span id="cb401-5"><a href="text-analysis.html#cb401-5"></a><span class="kw">require</span>(textdata)</span></code></pre></div>
<div id="preprocessing-and-setup" class="section level3">
<h3><span class="header-section-number">18.2.1</span> Preprocessing and Setup</h3>
<p>First, we must preprocess the corpus. Create a document-term matrix from the <code>lyrics</code> column of the <code>ts</code> dataframe. Complete the following preprocessing steps:</p>
<ul>
<li>Convert to lower.</li>
<li>Remove stop words.</li>
<li>Remove numbers.</li>
<li>Remove punctuation.</li>
</ul>
<p><strong>Think</strong>: Why is stemming inappropriate for this application?</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="text-analysis.html#cb402-1"></a>ts &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/taylor_swift.csv&quot;</span>)</span>
<span id="cb402-2"><a href="text-analysis.html#cb402-2"></a></span>
<span id="cb402-3"><a href="text-analysis.html#cb402-3"></a><span class="co"># Preprocess and create DTM</span></span>
<span id="cb402-4"><a href="text-analysis.html#cb402-4"></a>docs &lt;-<span class="st"> </span><span class="kw">Corpus</span>(<span class="kw">VectorSource</span>(ts<span class="op">$</span>lyrics))</span>
<span id="cb402-5"><a href="text-analysis.html#cb402-5"></a></span>
<span id="cb402-6"><a href="text-analysis.html#cb402-6"></a>dtm &lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(docs,</span>
<span id="cb402-7"><a href="text-analysis.html#cb402-7"></a>           <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">tolower =</span> <span class="ot">TRUE</span>,</span>
<span id="cb402-8"><a href="text-analysis.html#cb402-8"></a>                          <span class="dt">removeNumbers =</span> <span class="ot">TRUE</span>,</span>
<span id="cb402-9"><a href="text-analysis.html#cb402-9"></a>                          <span class="dt">removePunctuation =</span> <span class="ot">TRUE</span>,</span>
<span id="cb402-10"><a href="text-analysis.html#cb402-10"></a>                          <span class="dt">stopwords =</span> <span class="ot">TRUE</span></span>
<span id="cb402-11"><a href="text-analysis.html#cb402-11"></a>                         ))</span>
<span id="cb402-12"><a href="text-analysis.html#cb402-12"></a></span>
<span id="cb402-13"><a href="text-analysis.html#cb402-13"></a><span class="co"># Convert to dataframe</span></span>
<span id="cb402-14"><a href="text-analysis.html#cb402-14"></a>dtm &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">as.matrix</span>(dtm))</span></code></pre></div>
<div id="sentiment-dictionaries" class="section level4 unnumbered">
<h4>Sentiment Dictionaries</h4>
<p>We are going to use sentiment dictionaries from the <code>tidytext</code> package. Using the <code>get_sentiments</code> function, load the “bing” dictionary and store it in an object called <code>sent</code>.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="text-analysis.html#cb403-1"></a>sent &lt;-<span class="st"> </span><span class="kw">get_sentiments</span>(<span class="st">&quot;bing&quot;</span>)</span>
<span id="cb403-2"><a href="text-analysis.html#cb403-2"></a><span class="kw">head</span>(sent)</span>
<span id="cb403-3"><a href="text-analysis.html#cb403-3"></a><span class="co">#&gt; # A tibble: 6 x 2</span></span>
<span id="cb403-4"><a href="text-analysis.html#cb403-4"></a><span class="co">#&gt;   word       sentiment</span></span>
<span id="cb403-5"><a href="text-analysis.html#cb403-5"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;    </span></span>
<span id="cb403-6"><a href="text-analysis.html#cb403-6"></a><span class="co">#&gt; 1 2-faces    negative </span></span>
<span id="cb403-7"><a href="text-analysis.html#cb403-7"></a><span class="co">#&gt; 2 abnormal   negative </span></span>
<span id="cb403-8"><a href="text-analysis.html#cb403-8"></a><span class="co">#&gt; 3 abolish    negative </span></span>
<span id="cb403-9"><a href="text-analysis.html#cb403-9"></a><span class="co">#&gt; 4 abominable negative </span></span>
<span id="cb403-10"><a href="text-analysis.html#cb403-10"></a><span class="co">#&gt; 5 abominably negative </span></span>
<span id="cb403-11"><a href="text-analysis.html#cb403-11"></a><span class="co">#&gt; 6 abominate  negative</span></span></code></pre></div>
<p>We will now add a column to <code>sent</code> called <code>score</code>. This column should hold a “1” for positive words and “-1” for negative words.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="text-analysis.html#cb404-1"></a>sent<span class="op">$</span>score &lt;-<span class="st"> </span><span class="kw">ifelse</span>(sent<span class="op">$</span>sentiment<span class="op">==</span><span class="st">&quot;positive&quot;</span>, <span class="dv">1</span>, <span class="dv">-1</span>)</span></code></pre></div>
</div>
</div>
<div id="scoring-the-songs" class="section level3">
<h3><span class="header-section-number">18.2.2</span> Scoring the Songs</h3>
<p>We are now ready to score each song.</p>
<p>(<strong>NB</strong>: There are probably many ways to program a script that performs this task. If you can think of a more elegant way, go for it!)</p>
<p>First, we will create a dataframe that holds all the words in our DTM along with their sentiment score.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="text-analysis.html#cb405-1"></a><span class="co"># Get all the words in our DTM and put them in a dataframe</span></span>
<span id="cb405-2"><a href="text-analysis.html#cb405-2"></a>words =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">word =</span> <span class="kw">colnames</span>(dtm), <span class="dt">stringsAsFactors =</span> F)</span>
<span id="cb405-3"><a href="text-analysis.html#cb405-3"></a><span class="kw">head</span>(words)</span>
<span id="cb405-4"><a href="text-analysis.html#cb405-4"></a><span class="co">#&gt;        word</span></span>
<span id="cb405-5"><a href="text-analysis.html#cb405-5"></a><span class="co">#&gt; 1      back</span></span>
<span id="cb405-6"><a href="text-analysis.html#cb405-6"></a><span class="co">#&gt; 2 backroads</span></span>
<span id="cb405-7"><a href="text-analysis.html#cb405-7"></a><span class="co">#&gt; 3       bed</span></span>
<span id="cb405-8"><a href="text-analysis.html#cb405-8"></a><span class="co">#&gt; 4   believe</span></span>
<span id="cb405-9"><a href="text-analysis.html#cb405-9"></a><span class="co">#&gt; 5   beneath</span></span>
<span id="cb405-10"><a href="text-analysis.html#cb405-10"></a><span class="co">#&gt; 6    beside</span></span>
<span id="cb405-11"><a href="text-analysis.html#cb405-11"></a></span>
<span id="cb405-12"><a href="text-analysis.html#cb405-12"></a><span class="co"># Get their sentiment scores</span></span>
<span id="cb405-13"><a href="text-analysis.html#cb405-13"></a>words_sent &lt;-<span class="st"> </span>words <span class="op">%&gt;%</span></span>
<span id="cb405-14"><a href="text-analysis.html#cb405-14"></a><span class="st">  </span><span class="kw">left_join</span>(sent) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb405-15"><a href="text-analysis.html#cb405-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">score =</span> <span class="kw">replace_na</span>(score, <span class="dv">0</span>))</span>
<span id="cb405-16"><a href="text-analysis.html#cb405-16"></a><span class="co">#&gt; Joining, by = &quot;word&quot;</span></span></code></pre></div>
<p>We can now use matrix algebra (!!) to multiply our DTM by the scoring vector. This will return to us a score for each document (i.e., song).</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="text-analysis.html#cb406-1"></a><span class="co"># Calculate documents scores with matrix algebra! </span></span>
<span id="cb406-2"><a href="text-analysis.html#cb406-2"></a>doc_scores &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(dtm) <span class="op">%*%</span><span class="st"> </span>words_sent<span class="op">$</span>score</span>
<span id="cb406-3"><a href="text-analysis.html#cb406-3"></a></span>
<span id="cb406-4"><a href="text-analysis.html#cb406-4"></a><span class="co"># Put the scores in the original documents dataframe</span></span>
<span id="cb406-5"><a href="text-analysis.html#cb406-5"></a>ts<span class="op">$</span>sentiment &lt;-<span class="st"> </span>doc_scores</span></code></pre></div>
<p>Which song is happiest? Go listen to the song and see if you agree.</p>
</div>
<div id="challenges-18" class="section level3">
<h3><span class="header-section-number">18.2.3</span> Challenges</h3>
<div id="challenge-1.-16" class="section level4 unnumbered">
<h4>Challenge 1.</h4>
<p>Using the code we wrote above, make a function that accepts 1) a vector of texts and 2) a sentiment dictionary (i.e., a dataframe with words and scores) and returns a vector of sentiment scores for each text.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="text-analysis.html#cb407-1"></a>sentiment_score &lt;-<span class="st"> </span><span class="cf">function</span>(texts, sent_dict){</span>
<span id="cb407-2"><a href="text-analysis.html#cb407-2"></a>  </span>
<span id="cb407-3"><a href="text-analysis.html#cb407-3"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb407-4"><a href="text-analysis.html#cb407-4"></a></span>
<span id="cb407-5"><a href="text-analysis.html#cb407-5"></a>  <span class="kw">return</span>(doc_scores)</span>
<span id="cb407-6"><a href="text-analysis.html#cb407-6"></a>}</span>
<span id="cb407-7"><a href="text-analysis.html#cb407-7"></a>  </span>
<span id="cb407-8"><a href="text-analysis.html#cb407-8"></a><span class="co"># Uncomment to test it out!</span></span>
<span id="cb407-9"><a href="text-analysis.html#cb407-9"></a><span class="co"># sentiment_score(ts$lyrics, sent_dict)</span></span></code></pre></div>
</div>
<div id="challenge-2.-15" class="section level4 unnumbered">
<h4>Challenge 2.</h4>
<p>Using the function you wrote above, find out what the most and least positive Taylor Swift album is.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="text-analysis.html#cb408-1"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>

</div>
</div>
</div>
<div id="distinctive-words" class="section level2">
<h2><span class="header-section-number">18.3</span> Distinctive Words</h2>
<p>This lesson finds distinctive words in the speeches of Obama and Trump.</p>
<p>Run the following code to:</p>
<ol style="list-style-type: decimal">
<li>Import the corpus.</li>
<li>Create a DTM.</li>
</ol>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="text-analysis.html#cb409-1"></a><span class="kw">require</span>(tm)</span>
<span id="cb409-2"><a href="text-analysis.html#cb409-2"></a><span class="kw">require</span>(matrixStats) <span class="co"># For statistics</span></span>
<span id="cb409-3"><a href="text-analysis.html#cb409-3"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb409-4"><a href="text-analysis.html#cb409-4"></a></span>
<span id="cb409-5"><a href="text-analysis.html#cb409-5"></a><span class="co"># Import corpus</span></span>
<span id="cb409-6"><a href="text-analysis.html#cb409-6"></a>docs &lt;-<span class="st"> </span><span class="kw">Corpus</span>(<span class="kw">DirSource</span>(<span class="st">&quot;Data/trump_obama&quot;</span>))</span>
<span id="cb409-7"><a href="text-analysis.html#cb409-7"></a></span>
<span id="cb409-8"><a href="text-analysis.html#cb409-8"></a><span class="co"># Preprocess and create DTM</span></span>
<span id="cb409-9"><a href="text-analysis.html#cb409-9"></a>dtm &lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(docs,</span>
<span id="cb409-10"><a href="text-analysis.html#cb409-10"></a>           <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">tolower =</span> <span class="ot">TRUE</span>,</span>
<span id="cb409-11"><a href="text-analysis.html#cb409-11"></a>                          <span class="dt">removePunctuation =</span> <span class="ot">TRUE</span>,</span>
<span id="cb409-12"><a href="text-analysis.html#cb409-12"></a>                          <span class="dt">removeNumbers =</span> <span class="ot">TRUE</span>,</span>
<span id="cb409-13"><a href="text-analysis.html#cb409-13"></a>                          <span class="dt">stopwords =</span> <span class="ot">TRUE</span>,</span>
<span id="cb409-14"><a href="text-analysis.html#cb409-14"></a>                          <span class="dt">stemming=</span><span class="ot">TRUE</span>))</span>
<span id="cb409-15"><a href="text-analysis.html#cb409-15"></a></span>
<span id="cb409-16"><a href="text-analysis.html#cb409-16"></a><span class="co"># Print the dimensions of the DTM</span></span>
<span id="cb409-17"><a href="text-analysis.html#cb409-17"></a><span class="kw">dim</span>(dtm)</span>
<span id="cb409-18"><a href="text-analysis.html#cb409-18"></a><span class="co">#&gt; [1]   11 4094</span></span>
<span id="cb409-19"><a href="text-analysis.html#cb409-19"></a></span>
<span id="cb409-20"><a href="text-analysis.html#cb409-20"></a><span class="co"># Take a quick look</span></span>
<span id="cb409-21"><a href="text-analysis.html#cb409-21"></a><span class="kw">inspect</span>(dtm[,<span class="dv">100</span><span class="op">:</span><span class="dv">104</span>])</span>
<span id="cb409-22"><a href="text-analysis.html#cb409-22"></a><span class="co">#&gt; &lt;&lt;DocumentTermMatrix (documents: 11, terms: 5)&gt;&gt;</span></span>
<span id="cb409-23"><a href="text-analysis.html#cb409-23"></a><span class="co">#&gt; Non-/sparse entries: 14/41</span></span>
<span id="cb409-24"><a href="text-analysis.html#cb409-24"></a><span class="co">#&gt; Sparsity           : 75%</span></span>
<span id="cb409-25"><a href="text-analysis.html#cb409-25"></a><span class="co">#&gt; Maximal term length: 11</span></span>
<span id="cb409-26"><a href="text-analysis.html#cb409-26"></a><span class="co">#&gt; Weighting          : term frequency (tf)</span></span>
<span id="cb409-27"><a href="text-analysis.html#cb409-27"></a><span class="co">#&gt; Sample             :</span></span>
<span id="cb409-28"><a href="text-analysis.html#cb409-28"></a><span class="co">#&gt;                 Terms</span></span>
<span id="cb409-29"><a href="text-analysis.html#cb409-29"></a><span class="co">#&gt; Docs             alien align alik aliv allamerican</span></span>
<span id="cb409-30"><a href="text-analysis.html#cb409-30"></a><span class="co">#&gt;   Obama_2009.txt     0     0    1    0           0</span></span>
<span id="cb409-31"><a href="text-analysis.html#cb409-31"></a><span class="co">#&gt;   Obama_2010.txt     0     0    1    1           0</span></span>
<span id="cb409-32"><a href="text-analysis.html#cb409-32"></a><span class="co">#&gt;   Obama_2011.txt     0     1    0    0           0</span></span>
<span id="cb409-33"><a href="text-analysis.html#cb409-33"></a><span class="co">#&gt;   Obama_2012.txt     0     0    0    1           0</span></span>
<span id="cb409-34"><a href="text-analysis.html#cb409-34"></a><span class="co">#&gt;   Obama_2013.txt     0     0    0    0           0</span></span>
<span id="cb409-35"><a href="text-analysis.html#cb409-35"></a><span class="co">#&gt;   Obama_2014.txt     0     0    0    1           0</span></span>
<span id="cb409-36"><a href="text-analysis.html#cb409-36"></a><span class="co">#&gt;   Obama_2015.txt     1     0    1    0           0</span></span>
<span id="cb409-37"><a href="text-analysis.html#cb409-37"></a><span class="co">#&gt;   Trump_2017.txt     0     1    0    0           0</span></span>
<span id="cb409-38"><a href="text-analysis.html#cb409-38"></a><span class="co">#&gt;   Trump_2018.txt     1     0    0    0           1</span></span>
<span id="cb409-39"><a href="text-analysis.html#cb409-39"></a><span class="co">#&gt;   Trump_2019.txt     3     0    1    1           0</span></span></code></pre></div>
<p>Oftentimes scholars will want to compare different corpora by finding the words (or features) distinctive to each corpora. But finding distinctive words requires a decision about what “distinctive” means. As we will see, there are a variety of definitions that we might use.</p>
<div id="unique-usage" class="section level3">
<h3><span class="header-section-number">18.3.1</span> Unique Usage</h3>
<p>The most obvious definition of distinctive is “exclusive.” That is, distinctive words are those found exclusively in texts associated with a single speaker (or group). For example, if Trump uses the word “access” and Obama never does, we should count “access” as distinctive.
Finding words that are exclusive to a group is a simple exercise. All we have to do is sum the usage of each word use across all texts for each speaker and then look for cases where the sum is zero for one speaker.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="text-analysis.html#cb410-1"></a><span class="co"># Turn DTM into dataframe</span></span>
<span id="cb410-2"><a href="text-analysis.html#cb410-2"></a>dtm.m &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">as.matrix</span>(dtm))</span>
<span id="cb410-3"><a href="text-analysis.html#cb410-3"></a>dtm.m<span class="op">$</span>that &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># Fix weird encoding error with stop words</span></span>
<span id="cb410-4"><a href="text-analysis.html#cb410-4"></a>dtm.m<span class="op">$</span>dont &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb410-5"><a href="text-analysis.html#cb410-5"></a></span>
<span id="cb410-6"><a href="text-analysis.html#cb410-6"></a><span class="co"># Subset into 2 DTMs, 1 for each speaker</span></span>
<span id="cb410-7"><a href="text-analysis.html#cb410-7"></a>obama &lt;-<span class="st"> </span>dtm.m[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>,]</span>
<span id="cb410-8"><a href="text-analysis.html#cb410-8"></a>trump &lt;-<span class="st"> </span>dtm.m[<span class="dv">9</span><span class="op">:</span><span class="dv">11</span>,]</span>
<span id="cb410-9"><a href="text-analysis.html#cb410-9"></a></span>
<span id="cb410-10"><a href="text-analysis.html#cb410-10"></a><span class="co"># Sum word usage counts across all texts</span></span>
<span id="cb410-11"><a href="text-analysis.html#cb410-11"></a>obama &lt;-<span class="st"> </span><span class="kw">colSums</span>(obama)</span>
<span id="cb410-12"><a href="text-analysis.html#cb410-12"></a>trump &lt;-<span class="st"> </span><span class="kw">colSums</span>(trump)</span>
<span id="cb410-13"><a href="text-analysis.html#cb410-13"></a></span>
<span id="cb410-14"><a href="text-analysis.html#cb410-14"></a><span class="co"># Put those sums back into a dataframe</span></span>
<span id="cb410-15"><a href="text-analysis.html#cb410-15"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rbind</span>(obama, trump))</span>
<span id="cb410-16"><a href="text-analysis.html#cb410-16"></a>df[ ,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb410-17"><a href="text-analysis.html#cb410-17"></a><span class="co">#&gt;       abandon abess abid abil abject</span></span>
<span id="cb410-18"><a href="text-analysis.html#cb410-18"></a><span class="co">#&gt; obama       2     1    1    7      0</span></span>
<span id="cb410-19"><a href="text-analysis.html#cb410-19"></a><span class="co">#&gt; trump       1     0    0    1      1</span></span>
<span id="cb410-20"><a href="text-analysis.html#cb410-20"></a></span>
<span id="cb410-21"><a href="text-analysis.html#cb410-21"></a><span class="co"># Get words where one speaker&#39;s usage is 0</span></span>
<span id="cb410-22"><a href="text-analysis.html#cb410-22"></a>solelyobama &lt;-<span class="st"> </span><span class="kw">unlist</span>(df[<span class="dv">1</span>, trump<span class="op">==</span><span class="dv">0</span>]) </span>
<span id="cb410-23"><a href="text-analysis.html#cb410-23"></a>solelyobama &lt;-<span class="st"> </span>solelyobama[<span class="kw">order</span>(solelyobama, <span class="dt">decreasing =</span> T)] <span class="co"># Order them by frequency</span></span>
<span id="cb410-24"><a href="text-analysis.html#cb410-24"></a><span class="kw">head</span>(solelyobama, <span class="dv">10</span>) <span class="co"># Get top 10 words for Obama</span></span>
<span id="cb410-25"><a href="text-analysis.html#cb410-25"></a><span class="co">#&gt; technolog      bank     innov    doesnt   teacher      loan      wont     debat </span></span>
<span id="cb410-26"><a href="text-analysis.html#cb410-26"></a><span class="co">#&gt;        31        30        30        29        26        22        22        21 </span></span>
<span id="cb410-27"><a href="text-analysis.html#cb410-27"></a><span class="co">#&gt;    climat democraci </span></span>
<span id="cb410-28"><a href="text-analysis.html#cb410-28"></a><span class="co">#&gt;        19        19</span></span>
<span id="cb410-29"><a href="text-analysis.html#cb410-29"></a></span>
<span id="cb410-30"><a href="text-analysis.html#cb410-30"></a>solelytrump &lt;-<span class="st"> </span><span class="kw">unlist</span>(df[<span class="dv">2</span>, obama<span class="op">==</span><span class="dv">0</span>])</span>
<span id="cb410-31"><a href="text-analysis.html#cb410-31"></a>solelytrump &lt;-<span class="st"> </span>solelytrump[<span class="kw">order</span>(solelytrump, <span class="dt">decreasing =</span> T)] <span class="co"># Order them by frequency</span></span>
<span id="cb410-32"><a href="text-analysis.html#cb410-32"></a><span class="kw">head</span>(solelytrump, <span class="dv">10</span>) <span class="co"># Get top 10 words for Trump</span></span>
<span id="cb410-33"><a href="text-analysis.html#cb410-33"></a><span class="co">#&gt;      isi    agent america.  audienc    megan      it. obamacar     alic </span></span>
<span id="cb410-34"><a href="text-analysis.html#cb410-34"></a><span class="co">#&gt;        9        8        8        8        8        7        7        6 </span></span>
<span id="cb410-35"><a href="text-analysis.html#cb410-35"></a><span class="co">#&gt;   beauti    elvin </span></span>
<span id="cb410-36"><a href="text-analysis.html#cb410-36"></a><span class="co">#&gt;        6        6</span></span></code></pre></div>
<p>This is a start, but oftentimes these words tend not to be terribly interesting or informative, so we will remove them from our corpus in order to focus on identifying distinctive words that appear in texts associated with every speaker.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="text-analysis.html#cb411-1"></a><span class="co"># Subset df with non-zero entries</span></span>
<span id="cb411-2"><a href="text-analysis.html#cb411-2"></a>df &lt;-<span class="st"> </span>df[,trump<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>obama<span class="op">&gt;</span><span class="dv">0</span>]</span>
<span id="cb411-3"><a href="text-analysis.html#cb411-3"></a></span>
<span id="cb411-4"><a href="text-analysis.html#cb411-4"></a><span class="co"># How many words are we left with?</span></span>
<span id="cb411-5"><a href="text-analysis.html#cb411-5"></a><span class="kw">ncol</span>(df)</span>
<span id="cb411-6"><a href="text-analysis.html#cb411-6"></a><span class="co">#&gt; [1] 1525</span></span>
<span id="cb411-7"><a href="text-analysis.html#cb411-7"></a>df[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb411-8"><a href="text-analysis.html#cb411-8"></a><span class="co">#&gt;       abandon abil abl abort abraham</span></span>
<span id="cb411-9"><a href="text-analysis.html#cb411-9"></a><span class="co">#&gt; obama       2    7  15     1       1</span></span>
<span id="cb411-10"><a href="text-analysis.html#cb411-10"></a><span class="co">#&gt; trump       1    1   9     1       1</span></span></code></pre></div>
</div>
<div id="differences-in-frequencies" class="section level3">
<h3><span class="header-section-number">18.3.2</span> Differences in Frequencies</h3>
<p>Another basic approach to identifying distinctive words is to compare the frequencies at which speakers use a word. If one speaker uses a word often across his or her oeuvre, and another barely uses the word at all, the difference in their respective frequencies will be large. We can calculate this quantity the following way:</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="text-analysis.html#cb412-1"></a><span class="co"># Take the differences in frequencies</span></span>
<span id="cb412-2"><a href="text-analysis.html#cb412-2"></a>diffFreq &lt;-<span class="st"> </span>obama <span class="op">-</span><span class="st"> </span>trump</span>
<span id="cb412-3"><a href="text-analysis.html#cb412-3"></a></span>
<span id="cb412-4"><a href="text-analysis.html#cb412-4"></a><span class="co"># Sort the words</span></span>
<span id="cb412-5"><a href="text-analysis.html#cb412-5"></a>diffFreq &lt;-<span class="st"> </span><span class="kw">sort</span>(diffFreq, <span class="dt">decreasing =</span> T)</span>
<span id="cb412-6"><a href="text-analysis.html#cb412-6"></a></span>
<span id="cb412-7"><a href="text-analysis.html#cb412-7"></a><span class="co"># The top Obama words</span></span>
<span id="cb412-8"><a href="text-analysis.html#cb412-8"></a><span class="kw">head</span>(diffFreq, <span class="dv">10</span>)</span>
<span id="cb412-9"><a href="text-analysis.html#cb412-9"></a><span class="co">#&gt;     will     year      job     work     make      can american  america </span></span>
<span id="cb412-10"><a href="text-analysis.html#cb412-10"></a><span class="co">#&gt;      306      217      214      186      177      172      165      155 </span></span>
<span id="cb412-11"><a href="text-analysis.html#cb412-11"></a><span class="co">#&gt;      new    peopl </span></span>
<span id="cb412-12"><a href="text-analysis.html#cb412-12"></a><span class="co">#&gt;      150      147</span></span>
<span id="cb412-13"><a href="text-analysis.html#cb412-13"></a></span>
<span id="cb412-14"><a href="text-analysis.html#cb412-14"></a><span class="co"># The top Trump words</span></span>
<span id="cb412-15"><a href="text-analysis.html#cb412-15"></a><span class="kw">tail</span>(diffFreq, <span class="dv">10</span>)</span>
<span id="cb412-16"><a href="text-analysis.html#cb412-16"></a><span class="co">#&gt;  illeg immigr    isi    usa   hero   ryan border  great  thank   drug </span></span>
<span id="cb412-17"><a href="text-analysis.html#cb412-17"></a><span class="co">#&gt;     -9     -9     -9     -9    -11    -11    -13    -13    -19    -22</span></span></code></pre></div>
</div>
<div id="differences-in-averages" class="section level3">
<h3><span class="header-section-number">18.3.3</span> Differences in Averages</h3>
<p>This is a good start. But what if one speaker uses more words <em>overall</em>? Instead of using raw frequencies, a better approach would look at the average <em>rate</em> at which speakers use various words.</p>
<p>We can calculate this quantity the following way:</p>
<ol style="list-style-type: decimal">
<li>Normalize the DTM from counts to proportions.</li>
<li>Take the difference between one speaker’s proportion of a word and another’s proportion of the same word.</li>
<li>Find the words with the highest absolute difference.</li>
</ol>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="text-analysis.html#cb413-1"></a><span class="co"># Normalize into proportions</span></span>
<span id="cb413-2"><a href="text-analysis.html#cb413-2"></a>rowTotals &lt;-<span class="st"> </span><span class="kw">rowSums</span>(df) <span class="co"># Create vector with row totals, i.e., total number of words per document</span></span>
<span id="cb413-3"><a href="text-analysis.html#cb413-3"></a><span class="kw">head</span>(rowTotals) <span class="co"># Notice that one speaker uses more words than the other</span></span>
<span id="cb413-4"><a href="text-analysis.html#cb413-4"></a><span class="co">#&gt; obama trump </span></span>
<span id="cb413-5"><a href="text-analysis.html#cb413-5"></a><span class="co">#&gt; 23021  7432</span></span>
<span id="cb413-6"><a href="text-analysis.html#cb413-6"></a></span>
<span id="cb413-7"><a href="text-analysis.html#cb413-7"></a><span class="co"># Change frequencies to proportions</span></span>
<span id="cb413-8"><a href="text-analysis.html#cb413-8"></a>df &lt;-<span class="st"> </span>df<span class="op">/</span>rowTotals <span class="co"># Change frequencies to proportions</span></span>
<span id="cb413-9"><a href="text-analysis.html#cb413-9"></a>df[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb413-10"><a href="text-analysis.html#cb413-10"></a><span class="co">#&gt;        abandon     abil      abl    abort  abraham</span></span>
<span id="cb413-11"><a href="text-analysis.html#cb413-11"></a><span class="co">#&gt; obama 8.69e-05 0.000304 0.000652 4.34e-05 4.34e-05</span></span>
<span id="cb413-12"><a href="text-analysis.html#cb413-12"></a><span class="co">#&gt; trump 1.35e-04 0.000135 0.001211 1.35e-04 1.35e-04</span></span>
<span id="cb413-13"><a href="text-analysis.html#cb413-13"></a></span>
<span id="cb413-14"><a href="text-analysis.html#cb413-14"></a><span class="co"># Get difference in proportions</span></span>
<span id="cb413-15"><a href="text-analysis.html#cb413-15"></a>means.obama &lt;-<span class="st"> </span>df[<span class="dv">1</span>,]</span>
<span id="cb413-16"><a href="text-analysis.html#cb413-16"></a>means.trump &lt;-<span class="st"> </span>df[<span class="dv">2</span>,]</span>
<span id="cb413-17"><a href="text-analysis.html#cb413-17"></a>score &lt;-<span class="st"> </span><span class="kw">unlist</span>(means.obama <span class="op">-</span><span class="st"> </span>means.trump)</span>
<span id="cb413-18"><a href="text-analysis.html#cb413-18"></a></span>
<span id="cb413-19"><a href="text-analysis.html#cb413-19"></a><span class="co"># Find words with highest difference</span></span>
<span id="cb413-20"><a href="text-analysis.html#cb413-20"></a>score &lt;-<span class="st"> </span><span class="kw">sort</span>(score, <span class="dt">decreasing =</span> T)</span>
<span id="cb413-21"><a href="text-analysis.html#cb413-21"></a><span class="kw">head</span>(score,<span class="dv">10</span>) <span class="co"># Top Obama words</span></span>
<span id="cb413-22"><a href="text-analysis.html#cb413-22"></a><span class="co">#&gt;     job    make    busi     let    need    work    help economi  energi     can </span></span>
<span id="cb413-23"><a href="text-analysis.html#cb413-23"></a><span class="co">#&gt; 0.00620 0.00541 0.00473 0.00426 0.00419 0.00407 0.00388 0.00378 0.00363 0.00346</span></span>
<span id="cb413-24"><a href="text-analysis.html#cb413-24"></a><span class="kw">tail</span>(score,<span class="dv">10</span>) <span class="co"># Top Trump words</span></span>
<span id="cb413-25"><a href="text-analysis.html#cb413-25"></a><span class="co">#&gt;   border  tonight   immigr     unit    state     drug     must    great </span></span>
<span id="cb413-26"><a href="text-analysis.html#cb413-26"></a><span class="co">#&gt; -0.00284 -0.00293 -0.00322 -0.00322 -0.00322 -0.00342 -0.00354 -0.00476 </span></span>
<span id="cb413-27"><a href="text-analysis.html#cb413-27"></a><span class="co">#&gt;    thank american </span></span>
<span id="cb413-28"><a href="text-analysis.html#cb413-28"></a><span class="co">#&gt; -0.00483 -0.00650</span></span></code></pre></div>
<p>This is a start. The problem with this measure is that it tends to highlight differences in very frequent words. For example, this method gives greater attention to a word that occurs 30 times per 1,000 words in Obama and 25 times per 1,000 in Trump than it does to a word that occurs 5 times per 1,000 words in Obama and 0.1 times per 1,000 words in Trump. This does not seem right. It seems important to recognize cases when one speaker uses a word frequently and another speaker barely uses it.</p>
<p>As this initial attempt suggests, identifying distinctive words will be a balancing act. When comparing two groups of texts, differences in the rates of frequent words will tend to be large relative to differences in the rates of rarer words. Human language is variable; some words occur more frequently than others regardless of who is writing. We need to find a way of adjusting our definition of distinctive in light of this.</p>
</div>
<div id="differences-in-averages-adjustment" class="section level3">
<h3><span class="header-section-number">18.3.4</span> Differences in Averages, Adjustment</h3>
<p>One adjustment that is easy to make is to divide the difference in speakers’ average rates by the average rate across all speakers. Since dividing a quantity by a large number will make that quantity smaller, our new distinctiveness score will tend to be lower for words that occur frequently. While this is merely a heuristic, it does move us in the right direction.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="text-analysis.html#cb414-1"></a><span class="co"># Get the average rate of all words across all speakers</span></span>
<span id="cb414-2"><a href="text-analysis.html#cb414-2"></a>means.all &lt;-<span class="st"> </span><span class="kw">colMeans</span>(df)</span>
<span id="cb414-3"><a href="text-analysis.html#cb414-3"></a></span>
<span id="cb414-4"><a href="text-analysis.html#cb414-4"></a><span class="co"># Now divide the difference in speakers&#39; rates by the average rate across all speakers</span></span>
<span id="cb414-5"><a href="text-analysis.html#cb414-5"></a>score &lt;-<span class="st"> </span><span class="kw">unlist</span>((means.obama <span class="op">-</span><span class="st"> </span>means.trump) <span class="op">/</span><span class="st"> </span>means.all)</span>
<span id="cb414-6"><a href="text-analysis.html#cb414-6"></a>score &lt;-<span class="st"> </span><span class="kw">sort</span>(score, <span class="dt">decreasing =</span> T)</span>
<span id="cb414-7"><a href="text-analysis.html#cb414-7"></a><span class="kw">head</span>(score,<span class="dv">10</span>) <span class="co"># Top Obama words</span></span>
<span id="cb414-8"><a href="text-analysis.html#cb414-8"></a><span class="co">#&gt;    student       cant       idea      money        oil     higher       earn </span></span>
<span id="cb414-9"><a href="text-analysis.html#cb414-9"></a><span class="co">#&gt;       1.78       1.77       1.70       1.67       1.67       1.66       1.60 </span></span>
<span id="cb414-10"><a href="text-analysis.html#cb414-10"></a><span class="co">#&gt; leadership   research    respons </span></span>
<span id="cb414-11"><a href="text-analysis.html#cb414-11"></a><span class="co">#&gt;       1.60       1.59       1.58</span></span>
<span id="cb414-12"><a href="text-analysis.html#cb414-12"></a><span class="kw">tail</span>(score,<span class="dv">10</span>) <span class="co"># Top Trump words</span></span>
<span id="cb414-13"><a href="text-analysis.html#cb414-13"></a><span class="co">#&gt;     drug    grace    death    heart   pillar southern  terribl   unfair </span></span>
<span id="cb414-14"><a href="text-analysis.html#cb414-14"></a><span class="co">#&gt;    -1.77    -1.80    -1.82    -1.82    -1.84    -1.84    -1.84    -1.84 </span></span>
<span id="cb414-15"><a href="text-analysis.html#cb414-15"></a><span class="co">#&gt;     gang     ryan </span></span>
<span id="cb414-16"><a href="text-analysis.html#cb414-16"></a><span class="co">#&gt;    -1.87    -1.90</span></span></code></pre></div>

</div>
</div>
<div id="structural-topic-models" class="section level2">
<h2><span class="header-section-number">18.4</span> Structural Topic Models</h2>
<p>This unit gives a brief overview of the <code>stm</code> (structural topic model) package. Please read the vignette for more detail.</p>
<p>Structural topic model is a way to estimate a topic model that includes document-level metadata. One can then see how topical prevalence changes according to that metadata.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="text-analysis.html#cb415-1"></a><span class="kw">library</span>(stm)</span></code></pre></div>
<p>The data we will be using for this unit consists of all articles about women published in the New York Times and Washington Post, 1980-2014. You worked with a subset of this data in your last homework.</p>
<p>Load the dataset. Notice that we have the text of the articles along with some metadata.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="text-analysis.html#cb416-1"></a><span class="co"># Load data</span></span>
<span id="cb416-2"><a href="text-analysis.html#cb416-2"></a>women &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/women-full.csv&#39;</span>)</span>
<span id="cb416-3"><a href="text-analysis.html#cb416-3"></a><span class="kw">names</span>(women)</span>
<span id="cb416-4"><a href="text-analysis.html#cb416-4"></a><span class="co">#&gt;  [1] &quot;BYLINE&quot;              &quot;TEXT.NO.NOUN&quot;        &quot;PUBLICATION&quot;        </span></span>
<span id="cb416-5"><a href="text-analysis.html#cb416-5"></a><span class="co">#&gt;  [4] &quot;TITLE&quot;               &quot;COUNTRY&quot;             &quot;COUNTRY_FINAL&quot;      </span></span>
<span id="cb416-6"><a href="text-analysis.html#cb416-6"></a><span class="co">#&gt;  [7] &quot;YEAR&quot;                &quot;UID&quot;                 &quot;COUNTRY_NR&quot;         </span></span>
<span id="cb416-7"><a href="text-analysis.html#cb416-7"></a><span class="co">#&gt; [10] &quot;entities&quot;            &quot;LENGTH&quot;              &quot;COUNTRY_TOP_PERCENT&quot;</span></span>
<span id="cb416-8"><a href="text-analysis.html#cb416-8"></a><span class="co">#&gt; [13] &quot;COUNTRY_CODE&quot;        &quot;TEXT&quot;                &quot;DATE&quot;               </span></span>
<span id="cb416-9"><a href="text-analysis.html#cb416-9"></a><span class="co">#&gt; [16] &quot;COUNTRY_MAJOR&quot;       &quot;TYPE&quot;                &quot;REGION&quot;             </span></span>
<span id="cb416-10"><a href="text-analysis.html#cb416-10"></a><span class="co">#&gt; [19] &quot;SUBJECT&quot;</span></span></code></pre></div>
<div id="preprocessing-1" class="section level3">
<h3><span class="header-section-number">18.4.1</span> Preprocessing</h3>
<p>STM has its own unique preprocessing functions and procedure, which I have coded below. Notice that we are going to use the <code>TEXT.NO.NOUN</code> column, which contains all the text of the articles without proper nouns (which I removed earlier).</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="text-analysis.html#cb417-1"></a><span class="co"># Pre-process</span></span>
<span id="cb417-2"><a href="text-analysis.html#cb417-2"></a>temp&lt;-<span class="kw">textProcessor</span>(<span class="dt">documents =</span> women<span class="op">$</span>TEXT.NO.NOUN, <span class="dt">metadata =</span> women)</span>
<span id="cb417-3"><a href="text-analysis.html#cb417-3"></a><span class="co">#&gt; Building corpus... </span></span>
<span id="cb417-4"><a href="text-analysis.html#cb417-4"></a><span class="co">#&gt; Converting to Lower Case... </span></span>
<span id="cb417-5"><a href="text-analysis.html#cb417-5"></a><span class="co">#&gt; Removing punctuation... </span></span>
<span id="cb417-6"><a href="text-analysis.html#cb417-6"></a><span class="co">#&gt; Removing stopwords... </span></span>
<span id="cb417-7"><a href="text-analysis.html#cb417-7"></a><span class="co">#&gt; Removing numbers... </span></span>
<span id="cb417-8"><a href="text-analysis.html#cb417-8"></a><span class="co">#&gt; Stemming... </span></span>
<span id="cb417-9"><a href="text-analysis.html#cb417-9"></a><span class="co">#&gt; Creating Output...</span></span>
<span id="cb417-10"><a href="text-analysis.html#cb417-10"></a>meta&lt;-temp<span class="op">$</span>meta</span>
<span id="cb417-11"><a href="text-analysis.html#cb417-11"></a>vocab&lt;-temp<span class="op">$</span>vocab</span>
<span id="cb417-12"><a href="text-analysis.html#cb417-12"></a>docs&lt;-temp<span class="op">$</span>documents</span>
<span id="cb417-13"><a href="text-analysis.html#cb417-13"></a></span>
<span id="cb417-14"><a href="text-analysis.html#cb417-14"></a><span class="co"># Prep documents in the correct format</span></span>
<span id="cb417-15"><a href="text-analysis.html#cb417-15"></a>out &lt;-<span class="st"> </span><span class="kw">prepDocuments</span>(docs, vocab, meta)</span>
<span id="cb417-16"><a href="text-analysis.html#cb417-16"></a><span class="co">#&gt; Removing 19460 of 39403 terms (19460 of 1087166 tokens) due to frequency </span></span>
<span id="cb417-17"><a href="text-analysis.html#cb417-17"></a><span class="co">#&gt; Your corpus now has 4531 documents, 19943 terms and 1067706 tokens.</span></span>
<span id="cb417-18"><a href="text-analysis.html#cb417-18"></a>docs&lt;-out<span class="op">$</span>documents</span>
<span id="cb417-19"><a href="text-analysis.html#cb417-19"></a>vocab&lt;-out<span class="op">$</span>vocab</span>
<span id="cb417-20"><a href="text-analysis.html#cb417-20"></a>meta &lt;-out<span class="op">$</span>meta</span></code></pre></div>
<div id="challenge-1.-17" class="section level4 unnumbered">
<h4>Challenge 1.</h4>
<p>Read the help file for the <code>prepDocuments</code> function. Alter the code above (in 2.1) to keep only words that appear in at least 10 documents.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="text-analysis.html#cb418-1"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
</div>
</div>
<div id="estimate-model" class="section level3">
<h3><span class="header-section-number">18.4.2</span> Estimate Model</h3>
<p>We are now going to estimate a topic model with 15 topics by regressing topical prevalence on region and year covariates.</p>
<p>Running the full model takes a <strong>long</strong> time to finish. For that reason, we are going to add an argument <code>max.em.its</code>, which sets the number of iterations. By keeping it low (15), we will see a rough estimate of the topics. You can always go back and estimate the model to convergence.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="text-analysis.html#cb419-1"></a>model &lt;-<span class="st"> </span><span class="kw">stm</span>(docs, vocab, <span class="dv">15</span>, <span class="dt">prevalence =</span> <span class="op">~</span><span class="st"> </span>REGION <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(YEAR), <span class="dt">data =</span> meta, <span class="dt">seed =</span> <span class="dv">15</span>, <span class="dt">max.em.its =</span> <span class="dv">15</span>)</span></code></pre></div>
<p>Let’s see what our model came up with! The following tools can be used to evaluate the model:</p>
<ul>
<li><code>labelTopics</code> gives the top words for each topic.</li>
<li><code>findThoughts</code> gives the top documents for each topic (the documents with the highest proportion of each topic).</li>
</ul>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="text-analysis.html#cb420-1"></a><span class="co"># Top Words</span></span>
<span id="cb420-2"><a href="text-analysis.html#cb420-2"></a><span class="kw">labelTopics</span>(model)</span>
<span id="cb420-3"><a href="text-analysis.html#cb420-3"></a><span class="co">#&gt; Topic 1 Top Words:</span></span>
<span id="cb420-4"><a href="text-analysis.html#cb420-4"></a><span class="co">#&gt;       Highest Prob: show, design, fashion, women, art, one, like </span></span>
<span id="cb420-5"><a href="text-analysis.html#cb420-5"></a><span class="co">#&gt;       FREX: coutur, fashion, museum, sculptur, ready--wear, jacket, galleri </span></span>
<span id="cb420-6"><a href="text-analysis.html#cb420-6"></a><span class="co">#&gt;       Lift: ---inch, -ankl, alexandr, armatur, armhol, art-fair, avant </span></span>
<span id="cb420-7"><a href="text-analysis.html#cb420-7"></a><span class="co">#&gt;       Score: coutur, art, artist, fashion, museum, exhibit, cloth </span></span>
<span id="cb420-8"><a href="text-analysis.html#cb420-8"></a><span class="co">#&gt; Topic 2 Top Words:</span></span>
<span id="cb420-9"><a href="text-analysis.html#cb420-9"></a><span class="co">#&gt;       Highest Prob: said, polic, women, kill, report, offici, govern </span></span>
<span id="cb420-10"><a href="text-analysis.html#cb420-10"></a><span class="co">#&gt;       FREX: polic, suicid, kill, attack, investig, suspect, arrest </span></span>
<span id="cb420-11"><a href="text-analysis.html#cb420-11"></a><span class="co">#&gt;       Lift: abducte, charanjit, humanity-soak, male-control, sunil, kalpana, ciudad </span></span>
<span id="cb420-12"><a href="text-analysis.html#cb420-12"></a><span class="co">#&gt;       Score: polic, rape, kill, said, arrest, attack, investig </span></span>
<span id="cb420-13"><a href="text-analysis.html#cb420-13"></a><span class="co">#&gt; Topic 3 Top Words:</span></span>
<span id="cb420-14"><a href="text-analysis.html#cb420-14"></a><span class="co">#&gt;       Highest Prob: women, team, game, said, world, play, olymp </span></span>
<span id="cb420-15"><a href="text-analysis.html#cb420-15"></a><span class="co">#&gt;       FREX: tournament, championship, olymp, soccer, player, game, medal </span></span>
<span id="cb420-16"><a href="text-analysis.html#cb420-16"></a><span class="co">#&gt;       Lift: -america, -foot--inch, -hole, -kilomet, -rank, -round, -trump </span></span>
<span id="cb420-17"><a href="text-analysis.html#cb420-17"></a><span class="co">#&gt;       Score: olymp, championship, tournament, team, player, game, medal </span></span>
<span id="cb420-18"><a href="text-analysis.html#cb420-18"></a><span class="co">#&gt; Topic 4 Top Words:</span></span>
<span id="cb420-19"><a href="text-analysis.html#cb420-19"></a><span class="co">#&gt;       Highest Prob: book, year, life, first, write, novel, work </span></span>
<span id="cb420-20"><a href="text-analysis.html#cb420-20"></a><span class="co">#&gt;       FREX: novel, literari, fiction, book, memoir, novelist, poet </span></span>
<span id="cb420-21"><a href="text-analysis.html#cb420-21"></a><span class="co">#&gt;       Lift: buster, calla, goncourt, identical-twin, italian-american, kilcher, klone </span></span>
<span id="cb420-22"><a href="text-analysis.html#cb420-22"></a><span class="co">#&gt;       Score: novel, book, fiction, literari, poet, writer, write </span></span>
<span id="cb420-23"><a href="text-analysis.html#cb420-23"></a><span class="co">#&gt; Topic 5 Top Words:</span></span>
<span id="cb420-24"><a href="text-analysis.html#cb420-24"></a><span class="co">#&gt;       Highest Prob: women, said, femal, percent, militari, will, compani </span></span>
<span id="cb420-25"><a href="text-analysis.html#cb420-25"></a><span class="co">#&gt;       FREX: combat, board, quota, militari, bank, corpor, infantri </span></span>
<span id="cb420-26"><a href="text-analysis.html#cb420-26"></a><span class="co">#&gt;       Lift: -combat, cpr, gender-divers, nonexecut, outfitt, r-calif, r-ni </span></span>
<span id="cb420-27"><a href="text-analysis.html#cb420-27"></a><span class="co">#&gt;       Score: women, militari, infantri, combat, percent, quota, femal </span></span>
<span id="cb420-28"><a href="text-analysis.html#cb420-28"></a><span class="co">#&gt; Topic 6 Top Words:</span></span>
<span id="cb420-29"><a href="text-analysis.html#cb420-29"></a><span class="co">#&gt;       Highest Prob: protest, said, one, site, peopl, young, video </span></span>
<span id="cb420-30"><a href="text-analysis.html#cb420-30"></a><span class="co">#&gt;       FREX: orthodox, internet, web, video, rabbi, prayer, site </span></span>
<span id="cb420-31"><a href="text-analysis.html#cb420-31"></a><span class="co">#&gt;       Lift: balaclava, grrrl, tehrik-, braveheart, drawbridg, gravesit, guerrilla-styl </span></span>
<span id="cb420-32"><a href="text-analysis.html#cb420-32"></a><span class="co">#&gt;       Score: protest, site, orthodox, video, jewish, rabbi, xxxfx </span></span>
<span id="cb420-33"><a href="text-analysis.html#cb420-33"></a><span class="co">#&gt; Topic 7 Top Words:</span></span>
<span id="cb420-34"><a href="text-analysis.html#cb420-34"></a><span class="co">#&gt;       Highest Prob: women, work, said, year, percent, men, ese </span></span>
<span id="cb420-35"><a href="text-analysis.html#cb420-35"></a><span class="co">#&gt;       FREX: ese, factori, employ, incom, worker, job, market </span></span>
<span id="cb420-36"><a href="text-analysis.html#cb420-36"></a><span class="co">#&gt;       Lift: flextim, management-track, nec, nontransfer, rabenmutt, chiho, fumiko </span></span>
<span id="cb420-37"><a href="text-analysis.html#cb420-37"></a><span class="co">#&gt;       Score: ese, percent, compani, work, job, women, factori </span></span>
<span id="cb420-38"><a href="text-analysis.html#cb420-38"></a><span class="co">#&gt; Topic 8 Top Words:</span></span>
<span id="cb420-39"><a href="text-analysis.html#cb420-39"></a><span class="co">#&gt;       Highest Prob: women, sexual, sex, rape, men, violenc, said </span></span>
<span id="cb420-40"><a href="text-analysis.html#cb420-40"></a><span class="co">#&gt;       FREX: harass, sexual, sex, assault, brothel, violenc, behavior </span></span>
<span id="cb420-41"><a href="text-analysis.html#cb420-41"></a><span class="co">#&gt;       Lift: offenc, tarun, chaud, much-lov, newt, tiresom, sex-rel </span></span>
<span id="cb420-42"><a href="text-analysis.html#cb420-42"></a><span class="co">#&gt;       Score: rape, sexual, harass, violenc, sex, assault, brothel </span></span>
<span id="cb420-43"><a href="text-analysis.html#cb420-43"></a><span class="co">#&gt; Topic 9 Top Words:</span></span>
<span id="cb420-44"><a href="text-analysis.html#cb420-44"></a><span class="co">#&gt;       Highest Prob: women, said, right, law, islam, govern, religi </span></span>
<span id="cb420-45"><a href="text-analysis.html#cb420-45"></a><span class="co">#&gt;       FREX: islam, religi, veil, constitut, saudi, secular, cleric </span></span>
<span id="cb420-46"><a href="text-analysis.html#cb420-46"></a><span class="co">#&gt;       Lift: afghan-styl, anglo-, archdeacon, bien-aim, episcopaci, fez, government-encourag </span></span>
<span id="cb420-47"><a href="text-analysis.html#cb420-47"></a><span class="co">#&gt;       Score: islam, law, women, right, religi, ordin, saudi </span></span>
<span id="cb420-48"><a href="text-analysis.html#cb420-48"></a><span class="co">#&gt; Topic 10 Top Words:</span></span>
<span id="cb420-49"><a href="text-analysis.html#cb420-49"></a><span class="co">#&gt;       Highest Prob: said, one, famili, peopl, day, like, home </span></span>
<span id="cb420-50"><a href="text-analysis.html#cb420-50"></a><span class="co">#&gt;       FREX: villag, room, smile, son, couldnt, recal, sit </span></span>
<span id="cb420-51"><a href="text-analysis.html#cb420-51"></a><span class="co">#&gt;       Lift: charpoy, jet-black, mitra, schermerhorn, single-famili, tyson, uja-feder </span></span>
<span id="cb420-52"><a href="text-analysis.html#cb420-52"></a><span class="co">#&gt;       Score: villag, husband, fistula, famili, school, girl, said </span></span>
<span id="cb420-53"><a href="text-analysis.html#cb420-53"></a><span class="co">#&gt; Topic 11 Top Words:</span></span>
<span id="cb420-54"><a href="text-analysis.html#cb420-54"></a><span class="co">#&gt;       Highest Prob: women, film, one, like, woman, say, play </span></span>
<span id="cb420-55"><a href="text-analysis.html#cb420-55"></a><span class="co">#&gt;       FREX: film, theater, movi, charact, actress, documentari, audienc </span></span>
<span id="cb420-56"><a href="text-analysis.html#cb420-56"></a><span class="co">#&gt;       Lift: clive, fine-tun, kaffir, nushus, shrew, nushu, cadel </span></span>
<span id="cb420-57"><a href="text-analysis.html#cb420-57"></a><span class="co">#&gt;       Score: film, theater, movi, nushu, play, orchestra, femin </span></span>
<span id="cb420-58"><a href="text-analysis.html#cb420-58"></a><span class="co">#&gt; Topic 12 Top Words:</span></span>
<span id="cb420-59"><a href="text-analysis.html#cb420-59"></a><span class="co">#&gt;       Highest Prob: polit, elect, parti, minist, presid, govern, said </span></span>
<span id="cb420-60"><a href="text-analysis.html#cb420-60"></a><span class="co">#&gt;       FREX: voter, elect, parti, prime, candid, vote, cabinet </span></span>
<span id="cb420-61"><a href="text-analysis.html#cb420-61"></a><span class="co">#&gt;       Lift: ernesto, pinbal, influence-peddl, information-servic, kakuei, left--cent, marxist-leninist </span></span>
<span id="cb420-62"><a href="text-analysis.html#cb420-62"></a><span class="co">#&gt;       Score: elect, parti, vote, minist, voter, polit, candid </span></span>
<span id="cb420-63"><a href="text-analysis.html#cb420-63"></a><span class="co">#&gt; Topic 13 Top Words:</span></span>
<span id="cb420-64"><a href="text-analysis.html#cb420-64"></a><span class="co">#&gt;       Highest Prob: women, said, abort, cancer, health, studi, breast </span></span>
<span id="cb420-65"><a href="text-analysis.html#cb420-65"></a><span class="co">#&gt;       FREX: implant, cancer, breast, pill, virus, patient, estrogen </span></span>
<span id="cb420-66"><a href="text-analysis.html#cb420-66"></a><span class="co">#&gt;       Lift: acet, adren, ambulatori, analges, anastrozol, antioxid, ashkenazi </span></span>
<span id="cb420-67"><a href="text-analysis.html#cb420-67"></a><span class="co">#&gt;       Score: cancer, abort, breast, pill, implant, health, virus </span></span>
<span id="cb420-68"><a href="text-analysis.html#cb420-68"></a><span class="co">#&gt; Topic 14 Top Words:</span></span>
<span id="cb420-69"><a href="text-analysis.html#cb420-69"></a><span class="co">#&gt;       Highest Prob: women, said, confer, will, world, organ, right </span></span>
<span id="cb420-70"><a href="text-analysis.html#cb420-70"></a><span class="co">#&gt;       FREX: deleg, confer, forum, page, peac, nongovernment, ambassador </span></span>
<span id="cb420-71"><a href="text-analysis.html#cb420-71"></a><span class="co">#&gt;       Lift: -glass, barack, brooklyn-born, expansion, foreclosur, guarantor, holden </span></span>
<span id="cb420-72"><a href="text-analysis.html#cb420-72"></a><span class="co">#&gt;       Score: deleg, confer, forum, page, palestinian, peac, mrs </span></span>
<span id="cb420-73"><a href="text-analysis.html#cb420-73"></a><span class="co">#&gt; Topic 15 Top Words:</span></span>
<span id="cb420-74"><a href="text-analysis.html#cb420-74"></a><span class="co">#&gt;       Highest Prob: said, women, rape, court, case, girl, practic </span></span>
<span id="cb420-75"><a href="text-analysis.html#cb420-75"></a><span class="co">#&gt;       FREX: mutil, genit, circumcis, asylum, sentenc, judg, tribun </span></span>
<span id="cb420-76"><a href="text-analysis.html#cb420-76"></a><span class="co">#&gt;       Lift: labia, layli, minora, multifaith, paraleg, salim, strip-search </span></span>
<span id="cb420-77"><a href="text-analysis.html#cb420-77"></a><span class="co">#&gt;       Score: rape, genit, circumcis, mutil, court, sentenc, prosecutor</span></span>
<span id="cb420-78"><a href="text-analysis.html#cb420-78"></a></span>
<span id="cb420-79"><a href="text-analysis.html#cb420-79"></a><span class="co"># Example Docs</span></span>
<span id="cb420-80"><a href="text-analysis.html#cb420-80"></a><span class="kw">findThoughts</span>(model, <span class="dt">texts =</span> meta<span class="op">$</span>TITLE, <span class="dt">n=</span><span class="dv">2</span>,<span class="dt">topics =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">15</span>)</span>
<span id="cb420-81"><a href="text-analysis.html#cb420-81"></a><span class="co">#&gt; </span></span>
<span id="cb420-82"><a href="text-analysis.html#cb420-82"></a><span class="co">#&gt;  Topic 1: </span></span>
<span id="cb420-83"><a href="text-analysis.html#cb420-83"></a><span class="co">#&gt;       KENZO&#39;S CAREFREE STYLES AT AN OFFBEAT SHOWING</span></span>
<span id="cb420-84"><a href="text-analysis.html#cb420-84"></a><span class="co">#&gt;      A MODERN LOOK, A CLASSIC TOUCH FROM SAINT LAURENT </span></span>
<span id="cb420-85"><a href="text-analysis.html#cb420-85"></a><span class="co">#&gt;  Topic 2: </span></span>
<span id="cb420-86"><a href="text-analysis.html#cb420-86"></a><span class="co">#&gt;       Assailants Kill 4 Iraqi Women Working for U.S.; Gunmen Follow Van Carrying Laundry Employees</span></span>
<span id="cb420-87"><a href="text-analysis.html#cb420-87"></a><span class="co">#&gt;      WORLD IN BRIEF </span></span>
<span id="cb420-88"><a href="text-analysis.html#cb420-88"></a><span class="co">#&gt;  Topic 3: </span></span>
<span id="cb420-89"><a href="text-analysis.html#cb420-89"></a><span class="co">#&gt;       AMERICANS LEAD EAST GERMANS IN TRACK</span></span>
<span id="cb420-90"><a href="text-analysis.html#cb420-90"></a><span class="co">#&gt;      Russians Chart a New Path </span></span>
<span id="cb420-91"><a href="text-analysis.html#cb420-91"></a><span class="co">#&gt;  Topic 4: </span></span>
<span id="cb420-92"><a href="text-analysis.html#cb420-92"></a><span class="co">#&gt;       BEST SELLERS: September 6, 1998</span></span>
<span id="cb420-93"><a href="text-analysis.html#cb420-93"></a><span class="co">#&gt;      BEST SELLERS: September 13, 1998 </span></span>
<span id="cb420-94"><a href="text-analysis.html#cb420-94"></a><span class="co">#&gt;  Topic 5: </span></span>
<span id="cb420-95"><a href="text-analysis.html#cb420-95"></a><span class="co">#&gt;       In Britain, a Big Push for More Women to Serve on Corporate Boards</span></span>
<span id="cb420-96"><a href="text-analysis.html#cb420-96"></a><span class="co">#&gt;      Poll: Allow women in combat units </span></span>
<span id="cb420-97"><a href="text-analysis.html#cb420-97"></a><span class="co">#&gt;  Topic 6: </span></span>
<span id="cb420-98"><a href="text-analysis.html#cb420-98"></a><span class="co">#&gt;       Neda&#39;s Legacy; A woman&#39;s death moves Iranian protesters.</span></span>
<span id="cb420-99"><a href="text-analysis.html#cb420-99"></a><span class="co">#&gt;      Jewish Feminists Prompt Protests at Wailing Wall </span></span>
<span id="cb420-100"><a href="text-analysis.html#cb420-100"></a><span class="co">#&gt;  Topic 7: </span></span>
<span id="cb420-101"><a href="text-analysis.html#cb420-101"></a><span class="co">#&gt;       China Scrambles for Stability as Its Workers Age</span></span>
<span id="cb420-102"><a href="text-analysis.html#cb420-102"></a><span class="co">#&gt;      A high price for a paycheck; Caught between the demands of the corporate workplace and of their traditional roles in society, more South Korean women are putting off marriage and parenthood </span></span>
<span id="cb420-103"><a href="text-analysis.html#cb420-103"></a><span class="co">#&gt;  Topic 8: </span></span>
<span id="cb420-104"><a href="text-analysis.html#cb420-104"></a><span class="co">#&gt;       Confronting Rape in India, and Around the World</span></span>
<span id="cb420-105"><a href="text-analysis.html#cb420-105"></a><span class="co">#&gt;      Sexual Harassment Prosecutions Get Short Shrift in India, Lawyer Says </span></span>
<span id="cb420-106"><a href="text-analysis.html#cb420-106"></a><span class="co">#&gt;  Topic 9: </span></span>
<span id="cb420-107"><a href="text-analysis.html#cb420-107"></a><span class="co">#&gt;       English Church Advances Bid For Women As Bishops</span></span>
<span id="cb420-108"><a href="text-analysis.html#cb420-108"></a><span class="co">#&gt;      Egypt Passes Law On Women&#39;s Rights; Polygamy Still Allowed for Men </span></span>
<span id="cb420-109"><a href="text-analysis.html#cb420-109"></a><span class="co">#&gt;  Topic 10: </span></span>
<span id="cb420-110"><a href="text-analysis.html#cb420-110"></a><span class="co">#&gt;       An Old Cinema in Pakistan Has New Life After Quake</span></span>
<span id="cb420-111"><a href="text-analysis.html#cb420-111"></a><span class="co">#&gt;      Maria Duran&#39;s Endless Wait </span></span>
<span id="cb420-112"><a href="text-analysis.html#cb420-112"></a><span class="co">#&gt;  Topic 11: </span></span>
<span id="cb420-113"><a href="text-analysis.html#cb420-113"></a><span class="co">#&gt;       For France, An All-Purpose Heartthrob</span></span>
<span id="cb420-114"><a href="text-analysis.html#cb420-114"></a><span class="co">#&gt;      Film: Brazilian &#39;Vera&#39; </span></span>
<span id="cb420-115"><a href="text-analysis.html#cb420-115"></a><span class="co">#&gt;  Topic 12: </span></span>
<span id="cb420-116"><a href="text-analysis.html#cb420-116"></a><span class="co">#&gt;       The Widow Of Ex-Leader Wins Race In Panama</span></span>
<span id="cb420-117"><a href="text-analysis.html#cb420-117"></a><span class="co">#&gt;      Cabinet Defeated in Iceland as Feminists Gain </span></span>
<span id="cb420-118"><a href="text-analysis.html#cb420-118"></a><span class="co">#&gt;  Topic 13: </span></span>
<span id="cb420-119"><a href="text-analysis.html#cb420-119"></a><span class="co">#&gt;       SECTION: HEALTH; Pg. T18</span></span>
<span id="cb420-120"><a href="text-analysis.html#cb420-120"></a><span class="co">#&gt;      Dense Breasts May Need Sonograms to Detect Cancer </span></span>
<span id="cb420-121"><a href="text-analysis.html#cb420-121"></a><span class="co">#&gt;  Topic 14: </span></span>
<span id="cb420-122"><a href="text-analysis.html#cb420-122"></a><span class="co">#&gt;       DISPUTES ON KEY ISSUES STALL KENYA PARLEY</span></span>
<span id="cb420-123"><a href="text-analysis.html#cb420-123"></a><span class="co">#&gt;      &#39;CHAOTIC&#39; CONDITIONS FEARED AT U.N.&#39;S PARLEY ON WOMEN </span></span>
<span id="cb420-124"><a href="text-analysis.html#cb420-124"></a><span class="co">#&gt;  Topic 15: </span></span>
<span id="cb420-125"><a href="text-analysis.html#cb420-125"></a><span class="co">#&gt;       Woman Fleeing Tribal Rite Gains Asylum; Genital Mutilation Is Ruled Persecution</span></span>
<span id="cb420-126"><a href="text-analysis.html#cb420-126"></a><span class="co">#&gt;      Refugee From Mutilation</span></span></code></pre></div>
<div id="challenge-2.-16" class="section level4 unnumbered">
<h4>Challenge 2.</h4>
<p>Estimate other models using 5 and 40 topics, respectively. Look at the top words for each topic. How do the topics vary when you change the number of topics?</p>
<p>Now look at your neighbor’s model. Did you get the same results? Why or why not?</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="text-analysis.html#cb421-1"></a><span class="co"># YOUR CODE HERE</span></span></code></pre></div>
</div>
</div>
<div id="interpret-model" class="section level3">
<h3><span class="header-section-number">18.4.3</span> Interpret Model</h3>
<p>Let’s all load a fully-estimated model that I ran before class.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="text-analysis.html#cb422-1"></a><span class="co"># Load the already-estimated model</span></span>
<span id="cb422-2"><a href="text-analysis.html#cb422-2"></a><span class="kw">load</span>(<span class="st">&quot;data/stm.RData&quot;</span>)</span></code></pre></div>
<div id="challenge-3.-11" class="section level4 unnumbered">
<h4>Challenge 3.</h4>
<p>Using the functions <code>labelTopics</code> and <code>findThoughts</code>, hand label the 15 topics. Hold these labels as a character vector called <code>labels</code>.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="text-analysis.html#cb423-1"></a><span class="co"># Store your hand labels below</span></span>
<span id="cb423-2"><a href="text-analysis.html#cb423-2"></a>labels =<span class="st"> </span><span class="kw">c</span>()</span></code></pre></div>
<p>Now look at your neighbor’s labels. Did you get the same results? Why or why not?</p>
</div>
</div>
<div id="analyze-topics" class="section level3">
<h3><span class="header-section-number">18.4.4</span> Analyze Topics</h3>
<p>We are now going to see how the topics compare in terms of their prevalence across regions. What do you notice about the distribution of topic 9?</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="text-analysis.html#cb424-1"></a><span class="co"># Corpus summary</span></span>
<span id="cb424-2"><a href="text-analysis.html#cb424-2"></a><span class="kw">plot.STM</span>(model, <span class="dt">type=</span><span class="st">&quot;summary&quot;</span>, <span class="dt">custom.labels =</span> labels, <span class="dt">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb424-3"><a href="text-analysis.html#cb424-3"></a></span>
<span id="cb424-4"><a href="text-analysis.html#cb424-4"></a><span class="co"># Estimate covariate effects</span></span>
<span id="cb424-5"><a href="text-analysis.html#cb424-5"></a>prep &lt;-<span class="st"> </span><span class="kw">estimateEffect</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span> <span class="op">~</span><span class="st"> </span>REGION <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(YEAR), model, <span class="dt">meta =</span> meta, <span class="dt">uncertainty =</span> <span class="st">&quot;Global&quot;</span>, <span class="dt">documents=</span>docs)</span>
<span id="cb424-6"><a href="text-analysis.html#cb424-6"></a><span class="co">#&gt; Warning: Using formula(x) is deprecated when x is a character vector of length &gt; 1.</span></span>
<span id="cb424-7"><a href="text-analysis.html#cb424-7"></a><span class="co">#&gt;   Consider formula(paste(x, collapse = &quot; &quot;)) instead.</span></span>
<span id="cb424-8"><a href="text-analysis.html#cb424-8"></a></span>
<span id="cb424-9"><a href="text-analysis.html#cb424-9"></a><span class="co"># Plot topic 9 over regions</span></span>
<span id="cb424-10"><a href="text-analysis.html#cb424-10"></a>regions =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Asia&quot;</span>, <span class="st">&quot;EECA&quot;</span>, <span class="st">&quot;MENA&quot;</span>, <span class="st">&quot;Africa&quot;</span>, <span class="st">&quot;West&quot;</span>, <span class="st">&quot;LA&quot;</span>)</span>
<span id="cb424-11"><a href="text-analysis.html#cb424-11"></a><span class="kw">plot.estimateEffect</span>(prep, <span class="st">&quot;REGION&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;pointestimate&quot;</span>, <span class="dt">topics =</span> <span class="dv">9</span>, <span class="dt">printlegend =</span> <span class="ot">TRUE</span>, <span class="dt">labeltype =</span> <span class="st">&quot;custom&quot;</span>, <span class="dt">custom.labels =</span> regions, <span class="dt">main =</span> <span class="st">&quot;Women&#39;s Rights&quot;</span>, <span class="dt">ci.level =</span> <span class="fl">.95</span>, <span class="dt">nsims=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="plsc31101_files/figure-html/unnamed-chunk-493-1.png" width="70%" style="display: block; margin: auto;" /><img src="plsc31101_files/figure-html/unnamed-chunk-493-2.png" width="70%" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="collecting-data-from-the-web.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/plsc-31101/course/edit/master/15-text_data/15_1-Preprocessing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/plsc-31101/course/raw/master/15-text_data/15_1-Preprocessing.Rmd"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
